{
    "version": "https://jsonfeed.org/version/1",
    "title": "JustGo's æ”¶çº³ç›’",
    "subtitle": "a easy crypt0er",
    "icon": "https://justgo00.github.io/images/favicon.ico",
    "description": "A study crypto soon small chicken, hope big boss to give me advice.",
    "home_page_url": "https://justgo00.github.io",
    "items": [
        {
            "id": "https://justgo00.github.io/2023/12/25/%E5%AE%89%E6%B4%B5%E6%9D%AF2023/",
            "url": "https://justgo00.github.io/2023/12/25/%E5%AE%89%E6%B4%B5%E6%9D%AF2023/",
            "title": "2023å®‰æ´µæ¯-Crypto",
            "date_published": "2023-12-25T03:31:36.779Z",
            "content_html": "<h2 id=\"010101\"><a class=\"anchor\" href=\"#010101\">#</a> 010101</h2>\n<p>çˆ†ç ´ï¼Œ1024*1024 æ¬¡ï¼Œå‰ 1024 å¯¹åº”ä¿®æ”¹å‰ 1024 çš„ 1bitï¼Œåä¸€æ®µå°†å‰ 1024bit æ‰€å¯¹åº”åŒä½ç½®çš„å 1024 çš„ 0bit ä¿®æ”¹ï¼š</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> itertools</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> string <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> tqdm <span class=\"keyword\">import</span> tqdm</span><br><span class=\"line\"><span class=\"keyword\">from</span> hashlib <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level = <span class=\"string\">&#x27;debug&#x27;</span></span><br><span class=\"line\">sh = remote(<span class=\"string\">&#x27;124.71.177.14&#x27;</span>,<span class=\"number\">10001</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;SHA256(XXXX + &#x27;</span>)</span><br><span class=\"line\">m_known = sh.recvuntil(<span class=\"string\">b&#x27;)&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">c_known = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[<span class=\"number\">1</span>:-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">Ascii = ascii_letters + digits</span><br><span class=\"line\">m_unknown = <span class=\"string\">b&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i0 <span class=\"keyword\">in</span> tqdm(Ascii):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i1,i2,i3 <span class=\"keyword\">in</span> itertools.product(Ascii,Ascii,Ascii):</span><br><span class=\"line\">        m = i0.encode() + i1.encode() + i2.encode() + i3.encode() + m_known</span><br><span class=\"line\">        c_solve = sha256(m).hexdigest()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> c_solve.encode() == c_known:</span><br><span class=\"line\">            m_unknown = m[:<span class=\"number\">4</span>]</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(m[:<span class=\"number\">4</span>])</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> m_unknown != <span class=\"string\">b&#x27;&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;&#x27;</span>)</span><br><span class=\"line\">sh.sendline(m_unknown)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;Press 1 to get ciphertext\\n&#x27;</span>)</span><br><span class=\"line\">sh.sendline(<span class=\"string\">b&#x27;1&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">n = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">p = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">c = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">n,p_known,c = <span class=\"built_in\">int</span>(n),<span class=\"built_in\">int</span>(p,<span class=\"number\">2</span>),<span class=\"built_in\">int</span>(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(n,p_known,c)</span><br><span class=\"line\"></span><br><span class=\"line\">e = <span class=\"number\">0x10001</span></span><br><span class=\"line\">n = <span class=\"number\">885983193330755862005421247616105018942989165564963248083196682778021687404725116205758532359230072109355057113176745993086046874992925681698732927956823144030544013403426664483828711784255207117812283782681837126423783679562863518337176395284749780073960412125208393952124525159646274444665217290896126787684170805448442565664555299539711666174943969471006825812258358756824745037401137555298526929882292766111029300490063121373524346238063114172433615938645354409686896313314580870973495548679138895315769534586187306771908569870343586877965672172819609879499657150938722936944485993346872733207214842687595917538485861238806852747145196430318007990471683014094631056234990870642680506519838006418170006983170469428819529386928504313299730939890682958013318191665792174138119060525587618164675121894917626758509163927589509930935590342185009956501961781001064927114705461308725171114291836176969552208263672853013041884147111644068155653447312399470048809365358421891632003573766793772352523595268457863625033163582237082672224767638995946368013643923412110800009794579999793304374903021993490429741889439689166365301181273060863406348289054202480738054429706154124888813147212613948318674809000118429191483614325482418697249686101</span></span><br><span class=\"line\">p_known = <span class=\"number\">27891442645341471288170167216869935613920976137887903714313638802373006773267565599597204373102523757582428451329858211065310139216678459999734807018922017770060342702550735543090801248386258005345518262143850572941350241016988378819690890844218261015415182311461752769583929809807049921985214679177749792217513351089220995239090088571179761822479553794957519709643176122743020402215768885756118676348026660960511688983890880515870145420044585582165469826852127713925014399205933331554164478946203701557458374273244827503769991306663425004640455624211909357330253463008915366448637642808264987962486894003590879922041</span></span><br><span class=\"line\">c = <span class=\"number\">585916945391914465115368819351183359526081377461622585041225666478547897954029350225215418441222608050191715981095658092352275373749701502850381217372771658130509389954639107164299187894202113533621889807067721079089833596056885977558635329364744149038296978066724078873266864282028305897202414695133286240204104453243146969561040569389842916667285536168938123895394035293131279220072587276720004388170496602617541194685508969662744840432770817566840117877172279330120731008106275207810586452935984788123659380202281255276079278864811851119660051615361241155206094818377753866987816079644506943531078103222458539480072218990226958339498588480585214108416830046393851200733516087801274551858537895962724967372863511751246954538846463631380334711400606890713243926153933570277830033910144086079076324194174249280583468477993446622039305710423098095332955373087159925072199054523679138339358536491961551107111839655380049809459883791190501195474617558590483712376958624790659126870216556072003004513759145118433460033394481622350881549992815614207757572142551506120859079610478414940856328923594079098496490363200474436684000424815011846049048890875566414602576298241173455275350978217308349078346435909878052426129101179058245263600719</span></span><br><span class=\"line\">p1_known = <span class=\"built_in\">bin</span>(p_known)[<span class=\"number\">2</span>:]</span><br><span class=\"line\">p1 = p1_known[:<span class=\"number\">1024</span>]</span><br><span class=\"line\">p2 = p1_known[<span class=\"number\">1024</span>:]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">len</span>(p1),<span class=\"built_in\">len</span>(p2))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> GCD(n,p_known) == <span class=\"number\">1</span>:</span><br><span class=\"line\">    p = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i1 <span class=\"keyword\">in</span> tqdm(<span class=\"built_in\">range</span>(<span class=\"number\">1024</span>)):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i2 <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1024</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> p1[i1] == <span class=\"string\">&#x27;0&#x27;</span> <span class=\"keyword\">and</span> p1[i2] == <span class=\"string\">&#x27;1&#x27;</span>:</span><br><span class=\"line\">                P1 = (<span class=\"built_in\">int</span>(p1,<span class=\"number\">2</span>)&lt;&lt;<span class=\"number\">1024</span>) + <span class=\"built_in\">int</span>(p2,<span class=\"number\">2</span>) + <span class=\"number\">2</span>**(<span class=\"number\">2047</span> - i1) - <span class=\"number\">2</span>**(<span class=\"number\">1023</span> - i2)</span><br><span class=\"line\">                P2 = (<span class=\"built_in\">int</span>(p1,<span class=\"number\">2</span>)&lt;&lt;<span class=\"number\">1024</span>) + <span class=\"built_in\">int</span>(p2,<span class=\"number\">2</span>) + <span class=\"number\">2</span>**(<span class=\"number\">2047</span> - i1)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> GCD(n,P1) != <span class=\"number\">1</span>:</span><br><span class=\"line\">                    p = GCD(n,P1)</span><br><span class=\"line\">                    <span class=\"built_in\">print</span>(p)</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> GCD(n,P2) != <span class=\"number\">1</span>:</span><br><span class=\"line\">                    p = GCD(n,P2)</span><br><span class=\"line\">                    <span class=\"built_in\">print</span>(p)</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> p != <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    p = GCD(n,p_known)</span><br><span class=\"line\"></span><br><span class=\"line\">p = <span class=\"number\">27891442645341471288170167216869935613920976137887903714313638802373006773267565599597204373102523757582428451329858211065310139216678459999734807018922017770060342702550735543090801248386258005345518262143850572941350241016988381484121532678304425988276706116667650655091065110083480083677976382501413068597749642222518078714081408231112934118417548389150479280450192606559111455609884194333273079988435178895449202349279801593481805628636255775746819599262717656325368815400568015035479118603375807392104141506679622057326955381876697854105339628185292192129738578646170759229660295272111570930988796263602074568569</span></span><br><span class=\"line\">q = n//p</span><br><span class=\"line\">d = inverse(e,(p-<span class=\"number\">1</span>)*(q-<span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(long_to_bytes(<span class=\"built_in\">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"poa\"><a class=\"anchor\" href=\"#poa\">#</a> POA</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oYWNrbWQuaW8vQExpYW5neXVoby9yMTVOeXN5WmkjTGFiLVBPQQ==\">https://hackmd.io/@Liangyuho/r15NysyZi#Lab-POA</span></p>\n<p>asserts æœ‰é—®é¢˜ï¼šå¯ä»¥é€šè¿‡æ„é€ æœ€åä¸€ä¸ªå­—ç¬¦æ¥ä½¿å…¶æ»¡è¶³ num çš„åˆ¤æ–­æ¡ä»¶è¿‡å³å¯ã€‚</p>\n<p>Padding Oracle Attackï¼šç”±äºæœ€åä¸€ç›´æ˜¯ b'\\x04'*4 å°†å…¶æ›´æ”¹ä¸º b'\\x0i'*i å³å¯çˆ†ç ´é™¤æ­¤ä¹‹å¤–æœ€åä¸€ä½ï¼Œåˆ¤å®šæ˜¯ True å³é€šè¿‡éªŒè¯ï¼š</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> itertools</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> string <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> tqdm <span class=\"keyword\">import</span> tqdm</span><br><span class=\"line\"><span class=\"keyword\">from</span> hashlib <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># context.log_level = &#x27;Debug&#x27;</span></span><br><span class=\"line\">sh = remote(<span class=\"string\">&#x27;124.71.177.14&#x27;</span>,<span class=\"number\">10010</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;SHA256(XXXX + &#x27;</span>)</span><br><span class=\"line\">m_known = sh.recvuntil(<span class=\"string\">b&#x27;)&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">c_known = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[<span class=\"number\">1</span>:-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">Ascii = ascii_letters + digits</span><br><span class=\"line\">m_unknown = <span class=\"string\">b&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i0 <span class=\"keyword\">in</span> tqdm(Ascii):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i1,i2,i3 <span class=\"keyword\">in</span> itertools.product(Ascii,Ascii,Ascii):</span><br><span class=\"line\">        m = i0.encode() + i1.encode() + i2.encode() + i3.encode() + m_known</span><br><span class=\"line\">        c_solve = sha256(m).hexdigest()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> c_solve.encode() == c_known:</span><br><span class=\"line\">            m_unknown = m[:<span class=\"number\">4</span>]</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(m[:<span class=\"number\">4</span>])</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> m_unknown != <span class=\"string\">b&#x27;&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;&#x27;</span>)</span><br><span class=\"line\">sh.sendline(m_unknown)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;Welcome to AES System, please choose the following options:\\n1. encrypt the flag\\n2. decrypt the flag\\n&#x27;</span>)</span><br><span class=\"line\">sh.sendline(<span class=\"string\">b&#x27;1&#x27;</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;This is your flag: &#x27;</span>)</span><br><span class=\"line\">Cipher = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">IV = <span class=\"built_in\">bytes</span>.fromhex(Cipher[:<span class=\"number\">32</span>].decode())</span><br><span class=\"line\">Cipher1 = <span class=\"built_in\">bytes</span>.fromhex(Cipher[<span class=\"number\">32</span>:].decode())</span><br><span class=\"line\"></span><br><span class=\"line\">sh.sendline(<span class=\"string\">b&#x27;2&#x27;</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">b&#x27;Please enter ciphertext:\\n&#x27;</span>)</span><br><span class=\"line\">sh.sendline(Cipher)</span><br><span class=\"line\">sh.recv()</span><br><span class=\"line\"></span><br><span class=\"line\">m = <span class=\"string\">b&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">5</span>,<span class=\"number\">15</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> tqdm(<span class=\"built_in\">range</span>(<span class=\"number\">32</span>,<span class=\"number\">128</span>)):</span><br><span class=\"line\">        I = (i&lt;&lt;<span class=\"number\">24</span>) + (i&lt;&lt;<span class=\"number\">16</span>) + (i&lt;&lt;<span class=\"number\">8</span>) + i</span><br><span class=\"line\">        num = <span class=\"built_in\">len</span>(m)</span><br><span class=\"line\">        K = long_to_bytes(bytes_to_long(m[::-<span class=\"number\">1</span>])^bytes_to_long(IV[-<span class=\"number\">4</span>-num:-<span class=\"number\">4</span>])^bytes_to_long(long_to_bytes(i)*num))</span><br><span class=\"line\">        <span class=\"keyword\">if</span> bytes_to_long(K) != <span class=\"number\">0</span>:</span><br><span class=\"line\">            iv = IV[:<span class=\"number\">16</span>-i] + long_to_bytes(IV[-i]^j^i) + K + long_to_bytes(bytes_to_long(IV[-<span class=\"number\">4</span>:])^bytes_to_long(<span class=\"string\">b&#x27;\\x04&#x27;</span>*<span class=\"number\">4</span>)^I)</span><br><span class=\"line\">            cipher = <span class=\"built_in\">hex</span>(bytes_to_long(iv + Cipher1))[<span class=\"number\">2</span>:]</span><br><span class=\"line\">            sh.sendline(<span class=\"string\">b&#x27;2&#x27;</span>)</span><br><span class=\"line\">            sh.recvuntil(<span class=\"string\">b&#x27;Please enter ciphertext:\\n&#x27;</span>)</span><br><span class=\"line\">            sh.sendline(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;cipher&#125;</span>&#x27;</span>.encode())</span><br><span class=\"line\">            Asser = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> Asser == <span class=\"string\">b&#x27;True&#x27;</span>:</span><br><span class=\"line\">                m += long_to_bytes(j)</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            iv = IV[:<span class=\"number\">16</span> - i] + long_to_bytes(IV[-i] ^ j ^ i) + long_to_bytes(bytes_to_long(IV[-<span class=\"number\">4</span>:]) ^ bytes_to_long(<span class=\"string\">b&#x27;\\x04&#x27;</span> * <span class=\"number\">4</span>) ^ I)</span><br><span class=\"line\">            cipher = <span class=\"built_in\">hex</span>(bytes_to_long(iv + Cipher1))[<span class=\"number\">2</span>:]</span><br><span class=\"line\">            sh.sendline(<span class=\"string\">b&#x27;2&#x27;</span>)</span><br><span class=\"line\">            sh.recvuntil(<span class=\"string\">b&#x27;Please enter ciphertext:\\n&#x27;</span>)</span><br><span class=\"line\">            sh.sendline(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;cipher&#125;</span>&#x27;</span>.encode())</span><br><span class=\"line\">            Asser = sh.recvuntil(<span class=\"string\">b&#x27;\\n&#x27;</span>)[:-<span class=\"number\">1</span>]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> Asser == <span class=\"string\">b&#x27;True&#x27;</span>:</span><br><span class=\"line\">                m += long_to_bytes(j)</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(m[::-<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure></p>\n",
            "tags": []
        },
        {
            "id": "https://justgo00.github.io/2023/12/25/LUC_RSA/",
            "url": "https://justgo00.github.io/2023/12/25/LUC_RSA/",
            "title": "LUC_RSA",
            "date_published": "2023-12-25T03:21:34.887Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aC51LWJvcmRlYXV4LmZyL35nY2FzdGFnbi9wdWJsaS9jcnlwdG9fcXVhZC5wZGY=\">https://www.math.u-bordeaux.fr/~gcastagn/publi/crypto_quad.pdf</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wdWJsaWNhdGlvbi8yNjYyMzAzMF9BX05ld19Db21wdXRhdGlvbl9BbGdvcml0aG1fZm9yX2FfQ3J5cHRvc3lzdGVtX0Jhc2VkX29uX0x1Y2FzX0Z1bmN0aW9ucw==\">https://www.researchgate.net/publication/26623030_A_New_Computation_Algorithm_for_a_Cryptosystem_Based_on_Lucas_Functions</span></p>\n<p>æœ€è¿‘é€šè¿‡ qwb äº†è§£åˆ°äº†è¿™ä¸ªæ–°ä¸œè¥¿ï¼Œé¡ºæ‰‹è¿›ä¸€æ­¥åŠ æ·±äº†å¯¹äº LUCAS åºåˆ—çš„ç†è§£ã€‚</p>\n<h2 id=\"å…¸å‹ä¾‹é¢˜\"><a class=\"anchor\" href=\"#å…¸å‹ä¾‹é¢˜\">#</a> å…¸å‹ä¾‹é¢˜</h2>\n<h3 id=\"umass-ctf-2021-weird-rsa\"><a class=\"anchor\" href=\"#umass-ctf-2021-weird-rsa\">#</a> UMass CTF 2021 - Weird RSA</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> isPrime</span><br><span class=\"line\"></span><br><span class=\"line\">m, Q = <span class=\"string\">&quot;&quot;&quot;REDACTED&quot;&quot;&quot;</span>, <span class=\"number\">1</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">genPrimes</span>(<span class=\"params\">size</span>):</span><br><span class=\"line\">    base = random.getrandbits(size // <span class=\"number\">2</span>) &lt;&lt; size // <span class=\"number\">2</span></span><br><span class=\"line\">    base = base | (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">1023</span>) | (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">1022</span>) | <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        temp = base | random.getrandbits(size // <span class=\"number\">4</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> isPrime(temp):</span><br><span class=\"line\">            p = temp</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        temp = base | random.getrandbits(size // <span class=\"number\">4</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> isPrime(temp):</span><br><span class=\"line\">            q = temp</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (p, q)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">pow</span>(<span class=\"params\">m, e, n</span>):     </span><br><span class=\"line\">    <span class=\"keyword\">return</span> v(e)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">v</span>(<span class=\"params\">n</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> n == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> n == <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (m*v(n-<span class=\"number\">1</span>) - Q*v(n-<span class=\"number\">2</span>)) % N</span><br><span class=\"line\"></span><br><span class=\"line\">p, q = genPrimes(<span class=\"number\">1024</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">N = p * q</span><br><span class=\"line\">e = <span class=\"number\">0x10001</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;N:&quot;</span>, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;c:&quot;</span>, <span class=\"built_in\">pow</span>(m, e, N))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">N: 18378141703504870053256589621469911325593449136456168833252297256858537217774550712713558376586907139191035169090694633962713086351032581652760861668116820553602617805166170038411635411122411322217633088733925562474573155702958062785336418656834129389796123636312497589092777440651253803216182746548802100609496930688436148522617770670087143010376380205698834648595913982981670535389045333406092868158446779681106756879563374434867509327405933798082589697167457848396375382835193219251999626538126258606572805220878283429607438382521692951006432650132816122705167004219371235964716616826653226062550260270958038670427</span></span><br><span class=\"line\"><span class=\"string\">c: 14470740653145070679700019966554818534890999807830802232451906444910279478539396448114592242906623394239703347815141824698585119347592990685923384931479024856262941313458084648914561375377956072245149926143782368239175037299219241806241533201175001088200209202522586119648246842120571566051381821899459346757935757111233323915022287370687524912870425787594648397524189694991735372527387329346198018567010117587531474035014342584491831714256980975368294579192077738910916486139823489975038981139084864837358039928972730135031064241393391678984872799573965150169368237298603189344477806873779325227557835790957023000991</span></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"luc-rsa-solution\"><a class=\"anchor\" href=\"#luc-rsa-solution\">#</a> LUC-RSA Solution</h4>\n<p>So how does it work? Well to encrypt (as weâ€™ve seen) we calculate the e-th order Lucas sequence with P=m and Q=1. Then, to decrypt we calculate  the d-th order Lucas sequence with P=c and Q=1. Huh, sounds quite neat.  Our next step is to find the private exponent d, however thereâ€™s a  catch. We cannot use our familiar</p>\n<p>é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿå¥½å§ï¼Œä¸ºäº†åŠ å¯†ï¼ˆæ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼‰ï¼Œæˆ‘ä»¬è®¡ç®— P=m å’Œ Q=1 çš„ç¬¬ e é˜¶å¢å¡æ–¯åºåˆ—ã€‚ç„¶åï¼Œä¸ºäº†è§£å¯†ï¼Œæˆ‘ä»¬è®¡ç®— P=c å’Œ Q=1 çš„ç¬¬ d  é˜¶å¢å¡æ–¯åºåˆ—ã€‚å‘µå‘µï¼Œå¬èµ·æ¥å¾ˆæ•´æ´ã€‚æˆ‘ä»¬çš„ä¸‹ä¸€æ­¥æ˜¯æ‰¾åˆ°ç§æœ‰æŒ‡æ•° dï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = ~e % phi(N),</span><br></pre></td></tr></table></figure></p>\n<p>instead we use å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = ~e % LCM( (p +- 1), (q +- 1) ).</span><br></pre></td></tr></table></figure></p>\n<p>Now we end up with four possible decryption keys. We could easily try them all out, but we can also find the proper form from</p>\n<p>ç°åœ¨æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†å››ä¸ªå¯èƒ½çš„è§£å¯†å¯†é’¥ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å°è¯•å®ƒä»¬ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ä¸­æ‰¾åˆ°åˆé€‚çš„å½¢å¼</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = ~e % LCM( (p - LS(D/p)), (q - LS(D/q)) )</span><br></pre></td></tr></table></figure></p>\n<p>where LS is the Legendre symbol and D = C^2 - 4 the discriminant  (abc-formula, anyone?). Finally, just to speed things up, we implement a more efficient encryption function (provided by the challâ€™s author:  Soul). Now we can go and get ourselves a nice flag ğŸ˜ƒ.</p>\n<p>å…¶ä¸­ LS æ˜¯å‹’è®©å¾·ç¬¦å·ï¼ŒD = C^2 - 4 æ˜¯åˆ¤åˆ«å¼ï¼ˆabc å…¬å¼ï¼Œæœ‰äººå—ï¼Ÿæœ€åï¼Œä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªæ›´æœ‰æ•ˆçš„åŠ å¯†åŠŸèƒ½ï¼ˆç”± chall çš„ä½œè€… Soul æä¾›ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å»ç»™è‡ªå·±ä¹°ä¸€é¢æ¼‚äº®çš„æ——å¸œï¼š) äº†ã€‚</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> long_to_bytes</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Increase the Python recursion limit</span></span><br><span class=\"line\">sys.setrecursionlimit(<span class=\"number\">5000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># RSA Parameters</span></span><br><span class=\"line\">N = <span class=\"number\">18378141703504870053256589621469911325593449136456168833252297256858537217774550712713558376586907139191035169090694633962713086351032581652760861668116820553602617805166170038411635411122411322217633088733925562474573155702958062785336418656834129389796123636312497589092777440651253803216182746548802100609496930688436148522617770670087143010376380205698834648595913982981670535389045333406092868158446779681106756879563374434867509327405933798082589697167457848396375382835193219251999626538126258606572805220878283429607438382521692951006432650132816122705167004219371235964716616826653226062550260270958038670427</span></span><br><span class=\"line\">C = <span class=\"number\">14470740653145070679700019966554818534890999807830802232451906444910279478539396448114592242906623394239703347815141824698585119347592990685923384931479024856262941313458084648914561375377956072245149926143782368239175037299219241806241533201175001088200209202522586119648246842120571566051381821899459346757935757111233323915022287370687524912870425787594648397524189694991735372527387329346198018567010117587531474035014342584491831714256980975368294579192077738910916486139823489975038981139084864837358039928972730135031064241393391678984872799573965150169368237298603189344477806873779325227557835790957023000991</span></span><br><span class=\"line\">E = <span class=\"number\">0x10001</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># I used Fermat&#x27;s factorisation method to get p and q using SAGE</span></span><br><span class=\"line\">P = <span class=\"number\">135566004969921829046861317679102794894163252891621004552763069255612086965641424719754859767153782381891044077537624735662301899417143962916558791489710971298124937969427903581890089403413545652984524659790357002447801666607195021452029447206533810446315939039775701027454771450154054624400219767469987538497</span></span><br><span class=\"line\">Q = <span class=\"number\">135566004969921829046861317679102794894163252891621004552763069255612086965641424719754859767153782381891044077537624735662301899417143962916558791489710971298124937969427903581890089403413545652984524659790357002447801666607195021441224446867180097273643121640903324702747770969633717818870639347019154977691</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># LUCRSA Cryptosystem (based on second order Lucas sequence (!))</span></span><br><span class=\"line\"><span class=\"comment\"># See https://www.researchgate.net/publication/26623030_A_New_Computation_Algorithm_for_a_Cryptosystem_Based_on_Lucas_Functions</span></span><br><span class=\"line\">D = C**<span class=\"number\">2</span> - <span class=\"number\">4</span></span><br><span class=\"line\">LS_P = gmpy2.legendre(D,P)</span><br><span class=\"line\">LS_Q = gmpy2.legendre(D,Q)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Get that decryption bread</span></span><br><span class=\"line\">d = gmpy2.invert(E, gmpy2.lcm(P-LS_P, Q-LS_Q))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># If you can, prevent v_dict&#123;&#125; from initialising again as it&#x27;ll save you time for future computations :)</span></span><br><span class=\"line\">v_dict = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Function I got from Soul, what a nice guy!</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">v</span>(<span class=\"params\">n</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> n == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> n == <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m</span><br><span class=\"line\">    <span class=\"keyword\">if</span> n <span class=\"keyword\">in</span> v_dict.keys():</span><br><span class=\"line\">        <span class=\"keyword\">return</span> v_dict[n]</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">2</span> == <span class=\"number\">0</span>):</span><br><span class=\"line\">        ret = (<span class=\"built_in\">pow</span>(v(n // <span class=\"number\">2</span>), <span class=\"number\">2</span>, N) - <span class=\"number\">2</span> * <span class=\"built_in\">pow</span>(Q, n, N)) % N</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        ret = (m * <span class=\"built_in\">pow</span>(v(n // <span class=\"number\">2</span>), <span class=\"number\">2</span>, N) - Q * v(n // <span class=\"number\">2</span>) * v((n // <span class=\"number\">2</span>) - <span class=\"number\">1</span>) - m * <span class=\"built_in\">pow</span>(Q, n, N)) % N</span><br><span class=\"line\">    v_dict[n] = ret</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret</span><br><span class=\"line\"></span><br><span class=\"line\">m = C; Q = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Capturing the flag...&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">flag = v(d)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Got it!&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"n-p2q2\"><a class=\"anchor\" href=\"#n-p2q2\">#</a> n = p<sup>2*q</sup>2</h4>\n<p>hfctf2022 RRSSAAï¼ˆ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYubmp1cHQuZWR1LmNuL2FyY2hpdmVzLzc0MCNSUlNTQUElRUYlQkMlODk=\">https://ctf.njupt.edu.cn/archives/740#RRSSAAï¼‰</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aC51LWJvcmRlYXV4LmZyL35nY2FzdGFnbi9wdWJsaS9jcnlwdG9fcXVhZC5wZGY=\">https://www.math.u-bordeaux.fr/~gcastagn/publi/crypto_quad.pdf</span></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sage.rings.finite_rings.integer_mod <span class=\"keyword\">import</span> lucas</span><br><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> long_to_bytes</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\">sys.setrecursionlimit(<span class=\"number\">5000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">59969098213446598961510550233718258878862148298191323654672950330070587404726715299685997489142290693126366408044603303463518341243526241117556011994804902686998166238333549719269703453450958140262475942580009981324936992976252832887660977703209225426388975233018602730303262439218292062822981478737257836581</span></span><br><span class=\"line\">E = <span class=\"number\">970698965238639683403205181589498135440069660016843488485401994654202837058754446853559143754852628922125327583411039117445415303888796067576548626904070971514824878024057391507617988385537930417136322298476467215300995795105008488692961624917433064070351961856959734368784774555385603000155569897078026670993484466622344106374637350023474339105113172687604783395923403613555236693496567851779400707953027457705617050061193750124237055690801725151098972239120476113241310088089420901051617493693842562637896252448161948655455277146925913049354086353328749354876619287042077221173795354616472050669799421983520421287</span></span><br><span class=\"line\">C = <span class=\"number\">2757297249371055260112176788534868300821961060153993508569437878576838431569949051806118959108641317578931985550844206475198216543139472405873345269094341570473142756599117266569746703013099627523306340748466413993624965897996985230542275127290795414763432332819334757831671028121489964563214463689614865416498886490980692515184662350519034273510244222407505570929178897273048405431658365659592815446583970229985655015539079874797518564867199632672678818617933927005198847206019475149998468493858071672920824599672525667187482558622701227716212254925837398813278836428805193481064316937182435285668656233017810444672</span></span><br><span class=\"line\"></span><br><span class=\"line\">P = <span class=\"number\">7743971733771153102128801312798743998017713722732925283466018690899116898707556486947918196848489007935614742583856884731087798825462330340492923214926391</span></span><br><span class=\"line\">Q = <span class=\"number\">7743971733771153105036156209981171560215008954284943420880584133648389139833517283670475349302080701240378945438911146974137885250527042074631329729385091</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">assert</span> P*Q == N</span><br><span class=\"line\">D = C**<span class=\"number\">2</span> - <span class=\"number\">4</span></span><br><span class=\"line\">LS_P = gmpy2.legendre(D,P)</span><br><span class=\"line\">LS_Q = gmpy2.legendre(D,Q)</span><br><span class=\"line\"></span><br><span class=\"line\">d = gmpy2.invert(E, gmpy2.lcm(P-LS_P, Q-LS_Q))</span><br><span class=\"line\">inv_q, inv_p = inverse_mod(P, Q), inverse_mod(Q, P)</span><br><span class=\"line\"></span><br><span class=\"line\">rp, rq = lucas(k=inverse_mod(E, P-LS_P), P=C, Q=<span class=\"number\">1</span>, n=P)[<span class=\"number\">0</span>], lucas(k=inverse_mod(E, Q-LS_Q), P=C, Q=<span class=\"number\">1</span>, n=Q)[<span class=\"number\">0</span>]</span><br><span class=\"line\">r = crt(<span class=\"built_in\">int</span>(rp),<span class=\"built_in\">int</span>(rq),P,Q)</span><br><span class=\"line\"></span><br><span class=\"line\">vp=lucas(k=E, P=r, Q=<span class=\"number\">1</span>, n=P*P)[<span class=\"number\">0</span>]</span><br><span class=\"line\">tmp_p = C * inverse_mod(<span class=\"built_in\">int</span>(vp),P*P) %(P*P)</span><br><span class=\"line\">tmp_p = <span class=\"built_in\">int</span>(tmp_p - <span class=\"number\">1</span>) // P</span><br><span class=\"line\">mp = <span class=\"built_in\">int</span>(tmp_p * inv_p % P)</span><br><span class=\"line\"></span><br><span class=\"line\">vq=lucas(k=E, P=r, Q=<span class=\"number\">1</span>, n=Q*Q)[<span class=\"number\">0</span>]</span><br><span class=\"line\">tmp_q = C * inverse_mod(<span class=\"built_in\">int</span>(vq), Q*Q)%(Q*Q)</span><br><span class=\"line\">tmp_q = <span class=\"built_in\">int</span>(tmp_q - <span class=\"number\">1</span>) // Q</span><br><span class=\"line\">mq = <span class=\"built_in\">int</span>(tmp_q * inv_q % Q)</span><br><span class=\"line\"></span><br><span class=\"line\">flag = crt(mp,mq,P,Q)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure></p>\n<p>å®˜æ–¹æ¿å­ï¼š</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> gmpy2 <span class=\"keyword\">import</span> next_prime, iroot</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> getPrime, inverse, GCD, bytes_to_long, long_to_bytes</span><br><span class=\"line\"><span class=\"keyword\">from</span> sage.<span class=\"built_in\">all</span> <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">attack2</span>(<span class=\"params\">N, e, m, t, X, Y</span>):</span><br><span class=\"line\">    PR = PolynomialRing(QQ, <span class=\"string\">&#x27;x,y&#x27;</span>, <span class=\"number\">2</span>, order=<span class=\"string\">&#x27;lex&#x27;</span>)</span><br><span class=\"line\">    x, y = PR.gens()</span><br><span class=\"line\">    A = -(N-<span class=\"number\">1</span>)**<span class=\"number\">2</span></span><br><span class=\"line\">    F = x * y**<span class=\"number\">2</span> + A * x + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    G_polys = []</span><br><span class=\"line\">    <span class=\"comment\"># G_&#123;k,i_1,i_2&#125;(x,y) = x^&#123;i_1-k&#125;y_&#123;i_2-2k&#125;f(x,y)^&#123;k&#125;e^&#123;m-k&#125; </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(m + <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i_1 <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k, m+<span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i_2 <span class=\"keyword\">in</span> [<span class=\"number\">2</span>*k, <span class=\"number\">2</span>*k + <span class=\"number\">1</span>]:</span><br><span class=\"line\">                G_polys.append(x**(i_1-k) * y**(i_2-<span class=\"number\">2</span>*k) * F**k * e**(m-k))</span><br><span class=\"line\"></span><br><span class=\"line\">    H_polys = []</span><br><span class=\"line\">    <span class=\"comment\"># y_shift H_&#123;k,i_1,i_2&#125;(x,y) = y^&#123;i_2-2k&#125; f(x,y)^k e^&#123;m-k&#125;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(m + <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i_2 <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">2</span>*k+<span class=\"number\">2</span>, <span class=\"number\">2</span>*k+t+<span class=\"number\">1</span>):</span><br><span class=\"line\">            H_polys.append(y**(i_2-<span class=\"number\">2</span>*k) * F**k * e**(m-k))</span><br><span class=\"line\"></span><br><span class=\"line\">    polys = G_polys + H_polys</span><br><span class=\"line\">    monomials = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> poly <span class=\"keyword\">in</span> polys:</span><br><span class=\"line\">        monomials.append(poly.lm())</span><br><span class=\"line\">    </span><br><span class=\"line\">    dims1 = <span class=\"built_in\">len</span>(polys)</span><br><span class=\"line\">    dims2 = <span class=\"built_in\">len</span>(monomials)</span><br><span class=\"line\">    MM = matrix(QQ, dims1, dims2)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> idx, poly <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(polys):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> idx_, monomial <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(monomials):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> monomial <span class=\"keyword\">in</span> poly.monomials():</span><br><span class=\"line\">                MM[idx, idx_] = poly.monomial_coefficient(monomial) * monomial(X, Y)</span><br><span class=\"line\">    B = MM.LLL()</span><br><span class=\"line\"></span><br><span class=\"line\">    found_polynomials = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> pol1_idx <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(B.nrows()):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> pol2_idx <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(pol1_idx + <span class=\"number\">1</span>, B.nrows()):</span><br><span class=\"line\">            P = PolynomialRing(QQ, <span class=\"string\">&#x27;a,b&#x27;</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">            a, b = P.gens()</span><br><span class=\"line\">            pol1 = pol2 = <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> idx_, monomial <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(monomials):</span><br><span class=\"line\">                pol1 += monomial(a,b) * B[pol1_idx, idx_] / monomial(X, Y)</span><br><span class=\"line\">                pol2 += monomial(a,b) * B[pol2_idx, idx_] / monomial(X, Y)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># resultant</span></span><br><span class=\"line\">            rr = pol1.resultant(pol2)</span><br><span class=\"line\">            <span class=\"comment\"># are these good polynomials?</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> rr.is_zero() <span class=\"keyword\">or</span> rr.monomials() == [<span class=\"number\">1</span>]:</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;found them, using vectors <span class=\"subst\">&#123;pol1_idx&#125;</span>, <span class=\"subst\">&#123;pol2_idx&#125;</span>&quot;</span>)</span><br><span class=\"line\">                found_polynomials = <span class=\"literal\">True</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> found_polynomials:</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> found_polynomials:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    PRq = PolynomialRing(QQ, <span class=\"string\">&#x27;z&#x27;</span>)</span><br><span class=\"line\">    z = PRq.gen()</span><br><span class=\"line\">    rr = rr(z, z)</span><br><span class=\"line\">    soly = rr.roots()[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    ppol = pol1(z, soly)</span><br><span class=\"line\">    solx = ppol.roots()[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> solx, soly</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">seq</span>(<span class=\"params\">r, k, m</span>):</span><br><span class=\"line\">    v = vector(Zmod(m), [r, <span class=\"number\">2</span>])</span><br><span class=\"line\">    <span class=\"keyword\">if</span> k &gt;= <span class=\"number\">2</span>:</span><br><span class=\"line\">        M = Matrix(Zmod(m), [[r, -<span class=\"number\">1</span>], [<span class=\"number\">1</span>, <span class=\"number\">0</span>]])</span><br><span class=\"line\">        v = (M**(k-<span class=\"number\">1</span>)) * v</span><br><span class=\"line\">    ret = v[<span class=\"number\">0</span>] <span class=\"keyword\">if</span> k != <span class=\"number\">0</span> <span class=\"keyword\">else</span> v[<span class=\"number\">1</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">int</span>(ret)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">legendre_symbol</span>(<span class=\"params\">a, p</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Compute the Legendre symbol a|p using</span></span><br><span class=\"line\"><span class=\"string\">        Euler&#x27;s criterion. p is a prime, a is</span></span><br><span class=\"line\"><span class=\"string\">        relatively prime to p (if p divides</span></span><br><span class=\"line\"><span class=\"string\">        a, then a|p = 0)</span></span><br><span class=\"line\"><span class=\"string\">        Returns 1 if a has a square root modulo</span></span><br><span class=\"line\"><span class=\"string\">        p, -1 otherwise.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    ls = <span class=\"built_in\">pow</span>(<span class=\"number\">2</span>,(p-<span class=\"number\">1</span>)//<span class=\"number\">2</span>,p)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> -<span class=\"number\">1</span> <span class=\"keyword\">if</span> ls == p - <span class=\"number\">1</span> <span class=\"keyword\">else</span> ls</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decrypt</span>(<span class=\"params\">c, e, p, q</span>):</span><br><span class=\"line\">    d_p = &#123;<span class=\"number\">1</span>: <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(e, -<span class=\"number\">1</span>, p-<span class=\"number\">1</span>)), -<span class=\"number\">1</span>: <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(e, -<span class=\"number\">1</span>, p+<span class=\"number\">1</span>))&#125;</span><br><span class=\"line\">    d_q = &#123;<span class=\"number\">1</span>: <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(e, -<span class=\"number\">1</span>, q-<span class=\"number\">1</span>)), -<span class=\"number\">1</span>: <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(e, -<span class=\"number\">1</span>, q+<span class=\"number\">1</span>))&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    inv_q = <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(p, -<span class=\"number\">1</span>, q))</span><br><span class=\"line\">    inv_p = <span class=\"built_in\">int</span>(<span class=\"built_in\">pow</span>(q, -<span class=\"number\">1</span>, p))</span><br><span class=\"line\"></span><br><span class=\"line\">    i_p = legendre_symbol(c**<span class=\"number\">2</span>-<span class=\"number\">4</span>, p)</span><br><span class=\"line\">    i_q = legendre_symbol(c**<span class=\"number\">2</span>-<span class=\"number\">4</span>, q)</span><br><span class=\"line\">    r_p = seq(c, d_p[i_p], p)</span><br><span class=\"line\">    r_q = seq(c, d_q[i_q], q)</span><br><span class=\"line\"></span><br><span class=\"line\">    r = CRT([r_p, r_q], [p, q])</span><br><span class=\"line\">    v_rp = seq(r, e, p**<span class=\"number\">2</span>)</span><br><span class=\"line\">    t_p = <span class=\"built_in\">int</span>((c * <span class=\"built_in\">pow</span>(v_rp, -<span class=\"number\">1</span>, p**<span class=\"number\">2</span>)) % p**<span class=\"number\">2</span>)</span><br><span class=\"line\">    s_p = (t_p - <span class=\"number\">1</span>) // p</span><br><span class=\"line\"></span><br><span class=\"line\">    v_rq = seq(r, e, q**<span class=\"number\">2</span>)</span><br><span class=\"line\">    t_q = <span class=\"built_in\">int</span>((c * <span class=\"built_in\">pow</span>(v_rq, -<span class=\"number\">1</span>, q**<span class=\"number\">2</span>)) % q**<span class=\"number\">2</span>)</span><br><span class=\"line\">    s_q = (t_q - <span class=\"number\">1</span>) // q</span><br><span class=\"line\"></span><br><span class=\"line\">    m_p = (s_p * inv_p) % p</span><br><span class=\"line\">    m_q = (s_q * inv_q) % q</span><br><span class=\"line\"></span><br><span class=\"line\">    m = CRT([m_p, m_q], [p, q])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> m</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    n = <span class=\"number\">59969098213446598961510550233718258878862148298191323654672950330070587404726715299685997489142290693126366408044603303463518341243526241117556011994804902686998166238333549719269703453450958140262475942580009981324936992976252832887660977703209225426388975233018602730303262439218292062822981478737257836581</span></span><br><span class=\"line\">    e = <span class=\"number\">970698965238639683403205181589498135440069660016843488485401994654202837058754446853559143754852628922125327583411039117445415303888796067576548626904070971514824878024057391507617988385537930417136322298476467215300995795105008488692961624917433064070351961856959734368784774555385603000155569897078026670993484466622344106374637350023474339105113172687604783395923403613555236693496567851779400707953027457705617050061193750124237055690801725151098972239120476113241310088089420901051617493693842562637896252448161948655455277146925913049354086353328749354876619287042077221173795354616472050669799421983520421287</span></span><br><span class=\"line\">    c = <span class=\"number\">2757297249371055260112176788534868300821961060153993508569437878576838431569949051806118959108641317578931985550844206475198216543139472405873345269094341570473142756599117266569746703013099627523306340748466413993624965897996985230542275127290795414763432332819334757831671028121489964563214463689614865416498886490980692515184662350519034273510244222407505570929178897273048405431658365659592815446583970229985655015539079874797518564867199632672678818617933927005198847206019475149998468493858071672920824599672525667187482558622701227716212254925837398813278836428805193481064316937182435285668656233017810444672</span></span><br><span class=\"line\"></span><br><span class=\"line\">    alpha = ZZ(e).nbits() / ZZ(n).nbits()</span><br><span class=\"line\">    beta = <span class=\"number\">0.44</span></span><br><span class=\"line\">    nbits = <span class=\"number\">1024</span></span><br><span class=\"line\">    delta = <span class=\"number\">0.63</span></span><br><span class=\"line\"></span><br><span class=\"line\">    X = <span class=\"number\">2</span> ** <span class=\"built_in\">int</span>(nbits*(alpha+delta-<span class=\"number\">2</span>)+<span class=\"number\">3</span>)</span><br><span class=\"line\">    Y = <span class=\"number\">2</span> ** <span class=\"built_in\">int</span>(nbits*beta+<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    x, y = <span class=\"built_in\">map</span>(<span class=\"built_in\">int</span>, attack2(n, e, <span class=\"number\">8</span>, <span class=\"number\">12</span>, X, Y))</span><br><span class=\"line\">    p_minus_q = y</span><br><span class=\"line\">    p_plus_q = iroot(p_minus_q**<span class=\"number\">2</span> + <span class=\"number\">4</span> * n, <span class=\"number\">2</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    p = (p_minus_q + p_plus_q) // <span class=\"number\">2</span></span><br><span class=\"line\">    q = n // p</span><br><span class=\"line\">    <span class=\"keyword\">assert</span> p * q == n</span><br><span class=\"line\">    phi = (p**<span class=\"number\">2</span> - <span class=\"number\">1</span>) * (q**<span class=\"number\">2</span> - <span class=\"number\">1</span>)</span><br><span class=\"line\">    d = inverse(e, phi)</span><br><span class=\"line\">    m = decrypt(c, e, p, q)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></p>\n",
            "tags": []
        },
        {
            "id": "https://justgo00.github.io/2023/12/12/2023_%E9%B9%8F%E7%A8%8B%E6%9D%AF/",
            "url": "https://justgo00.github.io/2023/12/12/2023_%E9%B9%8F%E7%A8%8B%E6%9D%AF/",
            "title": "2023é¹ç¨‹æ¯",
            "date_published": "2023-12-11T16:44:41.573Z",
            "content_html": "<h3 id=\"leakyrsa\"><a class=\"anchor\" href=\"#leakyrsa\">#</a> [LeakyRSA]</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\">from secret import flag</span><br><span class=\"line\"></span><br><span class=\"line\">nbits=512</span><br><span class=\"line\">p=getPrime(nbits)</span><br><span class=\"line\">q=getPrime(nbits)</span><br><span class=\"line\"></span><br><span class=\"line\">leakBits = 262</span><br><span class=\"line\">leak = (p ^ q)  &gt;&gt; (nbits - leakBits)</span><br><span class=\"line\"></span><br><span class=\"line\">n=p*q</span><br><span class=\"line\">e=65537</span><br><span class=\"line\">m = bytes_to_long(flag)</span><br><span class=\"line\">c = pow(m,e,n)</span><br><span class=\"line\">print(p)</span><br><span class=\"line\">print(q)</span><br><span class=\"line\">print(&quot;n=%d&quot; %n)</span><br><span class=\"line\">print(&quot;c=%d&quot; %c)</span><br><span class=\"line\">print(&quot;leak=%d&quot; %leak)</span><br><span class=\"line\"># n=73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923      </span><br><span class=\"line\"># c=71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691      </span><br><span class=\"line\"># leak=2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br></pre></td></tr></table></figure></p>\n<p>é™¤äº†åŸºæœ¬å‚æ•°ï¼Œé¢˜ç›®è¿˜ç»™äº† çš„é«˜ 262 æ¯”ç‰¹ã€‚æ‰€ä»¥å¤§è‡´æ–¹å‘å°±æ˜¯åˆ©ç”¨è¿™ä¸ªä¿¡æ¯ï¼Œä»¥åŠ æ¥æ¢å¤ çš„é«˜ä½ï¼Œç„¶åå†èµ°ä¸€ä¸ª coppersmith å®Œæˆå¯¹ n çš„åˆ†è§£ã€‚</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦æ ¹æ®æ¡ä»¶ï¼Œå¯¹ è‡ªé«˜ä½è¿›è¡Œå‰ªæçˆ†ç ´ã€‚çº¦æŸçš„æ¡ä»¶æ€»å…±æœ‰å››æ¡ï¼š</p>\n<p>å…¶ä¸­æ¯”è¾ƒ â€œå¼ºâ€ çš„æ˜¯ ï¼Œæ¯å½“æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ª çš„æ¯”ç‰¹ï¼Œé‚£ä¹ˆæ­¤æ—¶ çš„å¯¹åº”æ¯”ç‰¹ä¹Ÿèƒ½ç¡®å®šã€‚  <code>xor(pnew,qnew) == leak[:2+i]</code></p>\n<p>å¦å¤–ä¸€ä¸ªæˆ‘ä»¬è¿™é‡Œç¨å¾®æ„ä¼šä¸€ä¸‹ï¼ˆå°±æ˜¯ä¸ä¸¥æ ¼è¯æ˜äº†ï¼‰ï¼Œå°±æ˜¯ é«˜ä½ç›¸ä¹˜çš„ç»“æœï¼Œå‰é¢å¤§çº¦ä¸€åŠçš„æ•°å’Œ çš„é«˜ä½æ˜¯ç›¸åŒçš„ã€‚ <code>tmp&gt;&gt;(tmp.bit_length()-i//2)== n&gt;&gt;(n.bit_length()-i//2)</code></p>\n<p>å½“æˆ‘ä»¬å®šä¸‹äº†å½“å‰ çš„é«˜ä½ï¼Œé‚£ä¹ˆ ä½ä½å…¨è¡¥ 0ï¼Œç„¶åå®ƒä»¬ç›¸ä¹˜çš„ç»“æœè¦å°äº ã€‚  <code>(int(pnew.ljust(512,'0'),2)*int(qnew.ljust(512,'0'),2) &lt; n)</code></p>\n<p>å½“æˆ‘ä»¬å®šä¸‹äº†å½“å‰ çš„é«˜ä½ï¼Œé‚£ä¹ˆ ä½ä½å…¨è¡¥ 1ï¼Œç„¶åå®ƒä»¬ç›¸ä¹˜çš„ç»“æœè¦å¤§äº ã€‚ <code>(int(pnew.ljust(512,'1'),2)*int(qnew.ljust(512,'1'),2) &gt; n)</code></p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\"></span><br><span class=\"line\">def xor(a,b):</span><br><span class=\"line\">    tmp = &quot;&quot;</span><br><span class=\"line\">    for i,j in zip(a,b):</span><br><span class=\"line\">        tmp+=str(ord(i)^ord(j))</span><br><span class=\"line\">    return tmp</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">nbits = 512</span><br><span class=\"line\">leakBits = 262</span><br><span class=\"line\"></span><br><span class=\"line\">leak=2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br><span class=\"line\">leak = bin(leak)[2:].rjust(262,&#x27;0&#x27;)</span><br><span class=\"line\">n=73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923      </span><br><span class=\"line\"></span><br><span class=\"line\">p=&#x27;1&#x27;</span><br><span class=\"line\">q=&#x27;1&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">P=[p]</span><br><span class=\"line\">Q=[q]</span><br><span class=\"line\">for i in range(261):</span><br><span class=\"line\">    PP=[]</span><br><span class=\"line\">    QQ=[]</span><br><span class=\"line\">    for a in &#x27;01&#x27;:</span><br><span class=\"line\">        for b in &#x27;01&#x27;:</span><br><span class=\"line\">            for pnew,qnew in zip(P,Q):</span><br><span class=\"line\">                pnew = pnew+a</span><br><span class=\"line\">                qnew = qnew+b</span><br><span class=\"line\">                tmp = int(pnew,2)*int(qnew,2)</span><br><span class=\"line\">                #print(tmp)</span><br><span class=\"line\">                if xor(pnew,qnew) == leak[:2+i] and  tmp&gt;&gt;(tmp.bit_length()-i//2)== n&gt;&gt;(n.bit_length()-i//2) and (int(pnew.ljust(512,&#x27;0&#x27;),2)*int(qnew.ljust(512,&#x27;0&#x27;),2) &lt; n)  and (int(pnew.ljust(512,&#x27;1&#x27;),2)*int(qnew.ljust(512,&#x27;1&#x27;),2) &gt; n) :</span><br><span class=\"line\">                    PP.append(pnew)</span><br><span class=\"line\">                    QQ.append(qnew)</span><br><span class=\"line\">    print(len(P))</span><br><span class=\"line\">    P = PP.copy()</span><br><span class=\"line\">    Q = QQ.copy()</span><br><span class=\"line\">print(P)</span><br><span class=\"line\"></span><br><span class=\"line\"># P = [&#x27;1000001000011100010101010110000111101011000100111100000111111100011001101101101110100111101010111011001100111101001100010011110010100000001100010100110110000110000100101000111110110000101100100010111111001101001000001001111101111010000011111000101010100100000010&#x27;, &#x27;1100111011010111101010100001110101111111100110111010101010011101100000101101010010101000010011001110110001011011011010000000100000111100111011101111100011110110111000000101100100101100100011111110011000101011011010100011001010101100111000100100110011001101000010&#x27;, &#x27;1000001000011100010101010110000111101011000100111100000111111100011001101101101110100111101010111011001100111101001100010011110010100000001100010100110110000110000100101000111110110000101100100010111111001101001000001001111101111010000011111000101100010000100010&#x27;, &#x27;1100111011010111101010100001110101111111100110111010101010011101100000101101010010101000010011001110110001011011011010000000100000111100111011101111100011110110111000000101100100101100100011111110011000101011011010100011001010101100111000100100110101111001100010&#x27;, &#x27;1000001000011100010101010110000111101011000100111100000111111100011001101101101110100111101010111011001100111101001100010011110010100000001100010100110110000110000100101000111110110000101100100010111111001101001000001001111101111010000011111000101100010000001010&#x27;, &#x27;1000001000011100010101010110000111101011000100111100000111111100011001101101101110100111101010111011001100111101001100010011110010100000001100010100110110000110000100101000111110110000101100100010111111001101001000001001111101111010000011111000101010100100000011&#x27;, &#x27;1100111011010111101010100001110101111111100110111010101010011101100000101101010010101000010011001110110001011011011010000000100000111100111011101111100011110110111000000101100100101100100011111110011000101011011010100011001010101100111000100100110011001101000011&#x27;, &#x27;1000001000011100010101010110000111101011000100111100000111111100011001101101101110100111101010111011001100111101001100010011110010100000001100010100110110000110000100101000111110110000101100100010111111001101001000001001111101111010000011111000101100010000100011&#x27;, &#x27;1100111011010111101010100001110101111111100110111010101010011101100000101101010010101000010011001110110001011011011010000000100000111100111011101111100011110110111000000101100100101100100011111110011000101011011010100011001010101100111000100100110101111001100011&#x27;, &#x27;1100111011010111101010100001110101111111100110111010101010011101100000101101010010101000010011001110110001011011011010000000100000111100111011101111100011110110111000000101100100101100100011111110011000101011011010100011001010101100111000100100110011001101101011&#x27;]</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œæˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°åä¸ªå¯èƒ½çš„ ï¼Œä¸è¿‡æ ¹æ®æˆ‘ä»¬çš„ä»£ç ï¼Œ æ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ„å‘³ç€å…¶ä¸­æœ‰ä¸¤ä¸ªå€¼æ˜¯æ­£ç¡®çš„ã€‚æˆ‘ä»¬éå†å…¶ä¸­çš„æ•°ï¼Œèµ°ä¸€ä¸ª coppersmith ã€‚ç”±äºè¿™é‡Œæ³„éœ²çš„æ¯”ç‰¹ä¸å¤šï¼Œç»è¿‡æµ‹è¯•ï¼Œå¦‚æœæƒ³æ¢å¤ 250 æ¯”ç‰¹çš„ä½ä½ï¼Œé‚£ä¹ˆéœ€è¦è®¾ç½®  <code>beta=0.47,epsilon=0.008</code> ï¼Œè·‘ä¸€æ¬¡æ¯”è¾ƒä¹…ã€‚è¿™é‡Œæˆ‘é€‰æ‹©å†çˆ†ç ´ 5 ä¸ªæ¯”ç‰¹ï¼Œè¿™æ ·å­å¯ä»¥è®¾  <code>epsilon=0.02</code> ï¼Œè·‘èµ·æ¥è¦ç¨å¾®å¿«äº›ã€‚</p>\n<p>æœ‰ç»“æœäº†ä¹‹åæ­£å¸¸è§£ä¸€ä¸ª RSA å°±å¯ä»¥äº†ã€‚</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from tqdm import *</span><br><span class=\"line\">R.&lt;x&gt; = Zmod(n)[]</span><br><span class=\"line\">for pbar in tqdm(P[::-1]):</span><br><span class=\"line\">    for i in range(32):</span><br><span class=\"line\"></span><br><span class=\"line\">        tmp = int(pbar,2)&lt;&lt;5</span><br><span class=\"line\">        tmp+=i</span><br><span class=\"line\">        f = tmp*2**245 + x</span><br><span class=\"line\">        xx = f.monic().small_roots(X=2^245,beta=0.47,epsilon=0.02)</span><br><span class=\"line\">        if xx:</span><br><span class=\"line\">            p = f(xx[0])</span><br><span class=\"line\">            print(p)</span><br><span class=\"line\"># 6814449132912466352143200200256605077873329465758477832056090562012411200107156482645933890997787435093806046493913273252717701817613907418845774345791241</span><br><span class=\"line\"></span><br><span class=\"line\">c=71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691      </span><br><span class=\"line\">n=73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923      </span><br><span class=\"line\">p=6814449132912466352143200200256605077873329465758477832056090562012411200107156482645933890997787435093806046493913273252717701817613907418845774345791241</span><br><span class=\"line\">q=n//p</span><br><span class=\"line\">d = inverse(65537,(p-1)*(q-1))</span><br><span class=\"line\">print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"neltharion_and_arthas\"><a class=\"anchor\" href=\"#neltharion_and_arthas\">#</a> [Neltharion_and_Arthas]</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import binascii</span><br><span class=\"line\">import hashlib</span><br><span class=\"line\">from flag import flag</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\">from Crypto.Util import *</span><br><span class=\"line\">import os</span><br><span class=\"line\"></span><br><span class=\"line\">key1 = os.urandom(32)</span><br><span class=\"line\">key2 = b&#x27;tn*-ix6L*tCa*&#125;i*&#x27;</span><br><span class=\"line\">key_len = len(key2)</span><br><span class=\"line\">assert flag.startswith(b&#x27;flag&#123;&#x27;)</span><br><span class=\"line\">assert (flag[13] == 45 and flag[18] == 45 and flag[23] == 45 and flag[28] == 45)</span><br><span class=\"line\">flag1 = b&quot;2023: &quot;+flag[:13]+flag[14:18]+flag[19:23]</span><br><span class=\"line\">flag2 = &#x27;a3eae82b4c491e0e&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">h = binascii.unhexlify(hashlib.sha256(key2).hexdigest())[:11]</span><br><span class=\"line\">gift1 = b&#x27;***********************************************************************************************&#x27;</span><br><span class=\"line\">gift2 = b&#x27;I tell you this, for when my days have come to an end , you, shall be King.&#x27;+h</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def encrypt1(message, key):</span><br><span class=\"line\">    cipher = AES.new(key, AES.MODE_CTR, counter=Counter.new(128))</span><br><span class=\"line\">    ciphertext = cipher.encrypt(message)</span><br><span class=\"line\">    return ciphertext.hex()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def encrypt2(message, key, iv):</span><br><span class=\"line\">    padding = bytes((key_len - len(message) % key_len) * &#x27;&amp;&#x27;, encoding=&#x27;utf-8&#x27;)</span><br><span class=\"line\">    message += padding</span><br><span class=\"line\">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class=\"line\">    ciphertext = cipher.encrypt(message)</span><br><span class=\"line\">    return ciphertext.hex()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">print(&quot;enc_gift1 = &quot;+encrypt1(gift1, key1))</span><br><span class=\"line\">print(&quot;enc_flag = &quot;+encrypt1(flag1, key1))</span><br><span class=\"line\">print(&quot;enc_gift2 = &quot;+encrypt2(gift2, key2, flag2))</span><br><span class=\"line\"></span><br><span class=\"line\"># enc_gift1 = bad7dbcff968d7cdbf51da011fe94e176fc8e7528e4dd85d2d5fc20ba69cefb7bfd03152a2874705bd2d857ea75b3216a830215db74772d9b9e9c218271d562694d3642d2917972fdb8c7363d8125730a50824cd8dc7e34cd4fa54be427cca</span><br><span class=\"line\"># enc_flag = c1c78891e30cd4c0aa5ed65c17e8550429c4e640881f9f1d6a56df</span><br><span class=\"line\"># enc_gift2 = ********c********b**************4***5********3****6a*****a**2********c*8******7***********3***5***2********e*5*************a******5**c***74***********fee046b4d2918096cfa3b76d6622914395c7e28eef</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é¢˜ç›®ä¸€çœ¼çœ‹è¿‡å»å°±çŸ¥é“è¦çˆ†ç ´äº†ï¼ˆçƒ¦äººã€‚ï¼‰ä¸è¿‡é¢˜ç›®æœ¬èº«æ¶‰åŠçš„çŸ¥è¯†ç‚¹å¹¶ä¸éš¾ï¼Œç¨å¾®äº†è§£è¿‡ CTR å’Œ CBC æ¨¡å¼å°±èƒ½åšäº†ã€‚</p>\n<p><img data-src=\"https://mmbiz.qpic.cn/sz_mmbiz_png/XpBS9rnxDafibiaFomS2g8k55FLBIVjaJ4yMXwGYkIibVen7MfqGuXbonTI0zFRagGLYIrNTj57gH4x74Yo6GWKDw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1\" alt=\"å›¾ç‰‡\" /></p>\n<p>é¦–å…ˆæ˜¯ flag çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œçœ‹åˆ°  <code>encrypt1</code>  å‡½æ•°ï¼Œä½¿ç”¨çš„æ˜¯  CTR æ¨¡å¼ï¼Œå¹¶ä¸”æ¯ä¸€æ¬¡çš„è®¡æ•°å™¨éƒ½æ˜¯ä»åŒä¸€ä¸ªä½ç½®å¼€å§‹ã€‚æˆ‘ä»¬çŸ¥é“ CTR æ¨¡å¼æ˜¯æœ‰ç‚¹ç±»ä¼¼äºæµå¯†ç çš„ï¼Œå› æ­¤é­å—ä¸ä½å·²çŸ¥æ˜æ–‡æ”»å‡»ã€‚è€Œé¢˜ç›®ä½¿ç”¨åŒæ ·çš„ key1 å¯¹ gift1 å’Œ flag1 åˆ†åˆ«è¿›è¡Œäº†ä¸€æ¬¡åŠ å¯†ï¼Œå› æ­¤åªè¦æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“ gift1 çš„å†…å®¹ï¼Œå°±èƒ½åˆ©ç”¨ gift1 å’Œå…¶å¯¹åº”å¯†æ–‡æ¥æ¢å¤ flag1 äº†ã€‚</p>\n<p>é¦–å…ˆçœ‹åˆ°  <code>flag1 = b&quot;2023: &quot;+flag[:13]+flag[14:18]+flag[19:23]</code> ï¼Œè€Œæ ¹æ®å‰é¢è§£å‡ºçš„ flagï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ¯”èµ›çš„ flag éƒ½æ˜¯  <code>flag&#123;&#125;</code>  çš„æ ¼å¼ã€‚äºæ˜¯ç›¸å½“äºæˆ‘ä»¬å·²ç»çŸ¥é“äº† flag1 çš„ 11 ä¸ªå­—èŠ‚çš„æ˜æ–‡ï¼Œå³  <code>2023: flag&#123;</code> ï¼Œå¯¹åº”çš„ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿæ¢å¤ 11 å­—èŠ‚çš„ gift1</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def xor(a,b):</span><br><span class=\"line\">    tmp = &quot;&quot;</span><br><span class=\"line\">    for i,j in zip(a,b):</span><br><span class=\"line\">        tmp+=chr(i^j)</span><br><span class=\"line\">    return tmp.encode(&#x27;latin1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">enc_gift1 = &#x27;bad7dbcff968d7cdbf51da011fe94e176fc8e7528e4dd85d2d5fc20ba69cefb7bfd03152a2874705bd2d857ea75b3216a830215db74772d9b9e9c218271d562694d3642d2917972fdb8c7363d8125730a50824cd8dc7e34cd4fa54be427cca&#x27;</span><br><span class=\"line\">enc_flag = &#x27;c1c78891e30cd4c0aa5ed65c17e8550429c4e640881f9f1d6a56df&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">enc_flag=bytes.fromhex(enc_flag)</span><br><span class=\"line\">enc_gift1=bytes.fromhex(enc_gift1)[:len(enc_flag)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ans = (xor(b&quot;2023: flag&#123;&quot;,xor(enc_gift1,enc_flag)))</span><br><span class=\"line\">print(ans)</span><br></pre></td></tr></table></figure></p>\n<p>æˆ‘ä»¬å¾—åˆ°  <code>b'I am Deathw'</code></p>\n<p>æ‹¿ç€è¿™ä¸ªé¢˜ç›®åå­—å»ç™¾åº¦æœï¼Œå¯ä»¥æœåˆ°ä¸€ä¸ªæš´é›ªçš„è‹±é›„ï¼Œæ­»äº¡ä¹‹ç¿¼ï¼Œå› æ­¤è¿™é‡Œåº”è¯¥æ˜¯ Deathwingï¼Œå†æœä¸€ä¸‹ï¼Œå°±èƒ½å¤Ÿæœåˆ°åŸå°è¯ï¼š <code>I am Deathwing, the destroyer, the end of all things,inevitable,indomitable,I am the cataclysm</code></p>\n<p>æœ€åå°±å¯ä»¥ç”¨è¿™ä¸ªåŸå°è¯æ¢å¤ flag1 äº†</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def xor(a,b):</span><br><span class=\"line\">    tmp = &quot;&quot;</span><br><span class=\"line\">    for i,j in zip(a,b):</span><br><span class=\"line\">        tmp+=chr(i^j)</span><br><span class=\"line\">    return tmp.encode(&#x27;latin1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">enc_gift1 = &#x27;bad7dbcff968d7cdbf51da011fe94e176fc8e7528e4dd85d2d5fc20ba69cefb7bfd03152a2874705bd2d857ea75b3216a830215db74772d9b9e9c218271d562694d3642d2917972fdb8c7363d8125730a50824cd8dc7e34cd4fa54be427cca&#x27;</span><br><span class=\"line\">enc_flag = &#x27;c1c78891e30cd4c0aa5ed65c17e8550429c4e640881f9f1d6a56df&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">enc_flag=bytes.fromhex(enc_flag)</span><br><span class=\"line\">enc_gift1=bytes.fromhex(enc_gift1)[:len(enc_flag)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ans = (xor(b&quot;I am Deathwing, the destroyer, the end of all things,inevitable,indomitable,I am the cataclysm&quot;,xor(enc_gift1,enc_flag)))</span><br><span class=\"line\">print(ans)</span><br></pre></td></tr></table></figure></p>\n<p>å¾—åˆ° ï¼š <code>b'2023: flag&#123;4ff732dd2b7445fd'</code></p>\n<p>ç„¶åçœ‹åˆ°  <code>encrypt2</code>  å‡½æ•°ï¼Œ</p>\n<p>ä½¿ç”¨çš„ CBC æ¨¡å¼ï¼Œ</p>\n<p>å¡«å……ç¬¦å·ç”¨çš„æ˜¯  <code>&amp;</code> ï¼Œ</p>\n<p>key2 ä¹Ÿç»™å‡ºäº†ç»å¤§éƒ¨åˆ†  <code>key2 = b'tn*-ix6L*tCa*&#125;i*'</code> ï¼Œ</p>\n<p>gift2 ä¸º  <code>gift2 = b'I tell you this, for when my days have come to an end , you, shall be King.'+h</code> ï¼Œå…¶ä¸­ h æ˜¯ key2 çš„ sha256 çš„å‰ 11 ä¸ªå­—èŠ‚ã€‚å› æ­¤æˆ‘ä»¬çŸ¥é“ gift2 çš„ç»å¤§éƒ¨åˆ†å†…å®¹ï¼Œä»¥åŠå…¶æœ€ç»ˆçš„å­—ç¬¦ä¸²é•¿åº¦ã€‚æµ‹ä¸€ä¸‹ä¸éš¾å¾—åˆ°åœ¨åŠ å¯†æ—¶ï¼Œ<strong>gift2 åé¢ä¼šå¡«å…… 10 ä¸ª &amp;ï¼Œè¿™æ˜¯æˆ‘ä»¬çˆ†ç ´ key2 çš„å…³é”®</strong>ã€‚</p>\n<p>æœ€å gift2 çš„å¯†æ–‡æ˜¯   <code>********c********b**************4***5********3****6a*****a**2********c*8******7***********3***5***2********e*5*************a******5**c***74***********fee046b4d2918096cfa3b76d6622914395c7e28eef</code> ï¼Œåªæœ‰æœ€åä¸€ç»„æ˜¯å®Œæ•´çš„ï¼Œå€’æ•°ç¬¬äºŒç»„åªæœ‰æœ€å 10 ä¸ªå­—ç¬¦ä¹Ÿå°±æ˜¯ 5 ä¸ªå­—èŠ‚ã€‚</p>\n<p><img data-src=\"https://mmbiz.qpic.cn/sz_mmbiz_png/XpBS9rnxDafibiaFomS2g8k55FLBIVjaJ4kOn13Ive5CUfpVa3XgpqMrskof2J4l1cObqdiccRgkoas1usAjICtXg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1\" alt=\"å›¾ç‰‡\" /></p>\n<p>çˆ†ç ´æ–¹æ¡ˆå°±æ˜¯ï¼Œæ ¹æ® CBC æ¨¡å¼ï¼Œæœ€åä¸€ç»„å¯†æ–‡ä½¿ç”¨ AES è§£å¯†åï¼Œè¿˜è¦å’Œå‰ä¸€ç»„å¯†æ–‡å¼‚æˆ–æ‰èƒ½å¾—åˆ°æ˜æ–‡ã€‚é‚£ä¹ˆè¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆçˆ†ç ´å¯†é’¥ key2ï¼Œç„¶åå¯¹æœ€åä¸€ç»„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œè§£å¯†åçš„æœ€å 5 ä¸ªå­—èŠ‚ï¼Œå’Œå€’æ•°ç¬¬äºŒç»„è¿˜ â€œå¹¸å­˜â€ çš„ 5 ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œå¦‚æœç»“æœæ˜¯ 5 ä¸ª  <code>&amp;</code>  å­—ç¬¦çš„è¯ï¼Œå°±è¯´æ˜çˆ†ç ´çš„å¯†é’¥ key2 æ­£ç¡®ã€‚</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from string import printable</span><br><span class=\"line\">from tqdm import *</span><br><span class=\"line\">enc_gift2 = &quot;fee046b4d2918096cfa3b76d6622914395c7e28eef&quot;</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\">def xor(a,b):</span><br><span class=\"line\">    tmp = &quot;&quot;</span><br><span class=\"line\">    for i,j in zip(a,b):</span><br><span class=\"line\">        tmp+=chr(i^j)</span><br><span class=\"line\">    return tmp.encode(&#x27;latin1&#x27;)</span><br><span class=\"line\">iv = bytes.fromhex(enc_gift2[:10])</span><br><span class=\"line\">cipher = bytes.fromhex(enc_gift2[-32:])</span><br><span class=\"line\">for i in tqdm(printable):</span><br><span class=\"line\">    for j in printable:</span><br><span class=\"line\">        for k in printable:</span><br><span class=\"line\">            for l in printable:</span><br><span class=\"line\">                key2 = &#x27;tn%s-ix6L%stCa%s&#125;i%s&#x27;%(i,j,k,l)</span><br><span class=\"line\">                dec = AES.new(key2.encode(), AES.MODE_ECB)</span><br><span class=\"line\">                m = dec.decrypt(cipher)</span><br><span class=\"line\">                m = xor(iv,m[-5:])</span><br><span class=\"line\">                if m == b&quot;&amp;&quot;*5:</span><br><span class=\"line\">                    print(key2)</span><br></pre></td></tr></table></figure></p>\n<p>æœ€åæˆ‘ä»¬å¾—åˆ°  <code>key2 = b'tn5-ix6L#tCaG&#125;i6'</code></p>\n<p>ä¸è¿‡ç”±äºè¿™é‡Œ flag2 æ˜¯ç”¨ä½œäº AES çš„ ivã€‚æƒ³è¦æ¢å¤è¿™ä¸ª iv å°±è¦ç”¨ gift2 ç¬¬ä¸€ç»„æ˜æ–‡çš„ AES å¯†æ–‡å’Œé€šè¿‡ CBC æ¨¡å¼å¾—åˆ°çš„å¯†æ–‡è¿›è¡Œå¼‚æˆ–ï¼ˆä¸ºäº†åŒºåˆ†ï¼Œæˆ‘ä»¬åˆ†åˆ«å«å®ƒä»¬ AES å¯†æ–‡ å’Œ CBC å¯†æ–‡å¥½äº†ï¼Œå…¶å®å°±æ˜¯å·®äº†ä¸€ä¸ªå¼‚æˆ–çš„å€¼ï¼‰ã€‚ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“ gift2 çš„ç¬¬ä¸€ç»„æ˜æ–‡äº†ï¼Œæƒ³è¦è·å–å…¶ AES å¯†æ–‡ åªéœ€è¦ç”¨ key2 åŠ å¯†ä¸€ä¸‹å°±å¥½äº†ã€‚é‚£ä¹ˆç›®å‰çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è·å¾—å…¶ CBC å¯†æ–‡ï¼Œå³è·å¾— ã€‚è€Œæƒ³è¦è·å¾—ç¬¬ä¸€ç»„çš„ CBC å¯†æ–‡ï¼Œæˆ‘ä»¬åªéœ€è¦è·å–ç¬¬äºŒç»„çš„ AES å¯†æ–‡å’Œ CBC å¯†æ–‡ï¼Œè®©ä»–ä»¬å¼‚æˆ–ä¸€ä¸‹å°±å¥½äº†ï¼Œè€Œè·å–ç¬¬äºŒç»„çš„ CBC å¯†æ–‡......ï¼Œå› æ­¤é—®é¢˜å°±æ¥åˆ°äº†æœ€åä¸€ç»„ã€‚è€Œæœ€åä¸€ç»„çš„ CBC å¯†æ–‡æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œç”±äº key2 çˆ†å‡ºæ¥äº†ï¼Œå…¶ sha256 æˆ‘ä»¬ä¹Ÿèƒ½ç®—ï¼Œåªéœ€è¦ 6 ä¸ªå­—èŠ‚ï¼Œå› ä¸ºè¿˜æœ‰ 10 ä¸ªå­—èŠ‚çš„å¡«å……ç¬¦å·  <code>&amp;</code> ï¼Œäºæ˜¯ AES å¯†æ–‡ä¹Ÿæœ‰äº†ï¼Œè¿™æ ·å°±èƒ½æœ‰å‰ä¸€ç»„çš„ CBC å¯†æ–‡ï¼Œæœ‰äº†å‰ä¸€ç»„çš„ CBC å¯†æ–‡ï¼Œå°±èƒ½æœ‰å‰å‰ä¸€ç»„çš„å¯†æ–‡äº†......</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\">import binascii</span><br><span class=\"line\">import hashlib</span><br><span class=\"line\"></span><br><span class=\"line\">def xor(a,b):</span><br><span class=\"line\">    tmp = &quot;&quot;</span><br><span class=\"line\">    for i,j in zip(a,b):</span><br><span class=\"line\">        tmp+=chr(i^j)</span><br><span class=\"line\">key2 = b&#x27;tn5-ix6L#tCaG&#125;i6&#x27;</span><br><span class=\"line\">enc_gift2 = &quot;918096cfa3b76d6622914395c7e28eef&quot;</span><br><span class=\"line\">h = binascii.unhexlify(hashlib.sha256(key2).hexdigest())[:11]</span><br><span class=\"line\">gift2 = b&#x27;I tell you this, for when my days have come to an end , you, shall be King.&#x27;+h</span><br><span class=\"line\">gift2 += b&#x27;&amp;&#x27;*10</span><br><span class=\"line\"></span><br><span class=\"line\">M = []</span><br><span class=\"line\">for i in range(0,len(gift2),16):</span><br><span class=\"line\">    M.append(gift2[i:i+16])</span><br><span class=\"line\">Minv = M[::-1]</span><br><span class=\"line\"></span><br><span class=\"line\">nowcipher = bytes.fromhex(enc_gift2)</span><br><span class=\"line\">for i in range(6):</span><br><span class=\"line\">    dec = AES.new(key2, AES.MODE_ECB)</span><br><span class=\"line\">    m = dec.decrypt(nowcipher)</span><br><span class=\"line\">    precipher = xor(Minv[i],m)</span><br><span class=\"line\">    nowcipher = precipher</span><br><span class=\"line\">print(precipher)</span><br></pre></td></tr></table></figure></p>\n<p>å¾—åˆ°  <code>a3eae82b4c491e0e</code></p>\n<p>ç»“åˆ  <code>assert (flag[13] == 45 and flag[18] == 45 and flag[23] == 45 and flag[28] == 45)</code></p>\n<p>æ˜¾ç„¶ flag æ˜¯ä¸€ä¸ª uuidï¼Œäºæ˜¯æœ€ç»ˆçš„ flag ä¸º  <code>flag&#123;4ff732dd-2b74-45fd-a3ea-e82b4c491e0e&#125;</code></p>\n<h3 id=\"colorful_matrix\"><a class=\"anchor\" href=\"#colorful_matrix\">#</a> [colorful_matrix]</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import random</span><br><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\">from Crypto.Util.Padding import pad</span><br><span class=\"line\">import gmpy2</span><br><span class=\"line\">import os</span><br><span class=\"line\">import hashlib</span><br><span class=\"line\">def xor(a, b):</span><br><span class=\"line\">    return bytes([a[i%len(a)] ^ b[i%len(b)] for i in range(max(len(a), len(b)))])</span><br><span class=\"line\">flag = b&#x27;flag&#123;xxxxxx&#125;&#x27;</span><br><span class=\"line\">key1 = hashlib.md5(os.urandom(16)).hexdigest().encode()</span><br><span class=\"line\">key2 = hashlib.md5(os.urandom(16)).hexdigest().encode()</span><br><span class=\"line\">num1 = 5</span><br><span class=\"line\">p = int(gmpy2.next_prime(bytes_to_long(key1 + os.urandom(64))))</span><br><span class=\"line\">ms = [random.getrandbits(256) for _ in range(num1)]</span><br><span class=\"line\">qs = [getPrime(1024) for _ in range(num1)]</span><br><span class=\"line\">ns = [p * qs[_] + ms[_] for _ in range(num1)]</span><br><span class=\"line\"></span><br><span class=\"line\">num2 = 37</span><br><span class=\"line\">x = bytes_to_long(key2 + os.urandom(32))</span><br><span class=\"line\">A = []</span><br><span class=\"line\">B = []</span><br><span class=\"line\">for i in range(num2):</span><br><span class=\"line\">    a = random.getrandbits(512)</span><br><span class=\"line\">    b = a * x % p</span><br><span class=\"line\">    gift = (2 ** 128 - 1) * 2 ** 400</span><br><span class=\"line\">    A.append(a)</span><br><span class=\"line\">    B.append((b &amp; gift) &gt;&gt; 400)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">bh + bm + bl = a * x + kp</span><br><span class=\"line\">bh * 2^528 + bl = a * x - bm * 2^400 + kp</span><br><span class=\"line\">238          400</span><br><span class=\"line\"></span><br><span class=\"line\">iv = long_to_bytes(random.getrandbits(128))</span><br><span class=\"line\">key = xor(key1,key2)</span><br><span class=\"line\">aes = AES.new(key1,AES.MODE_CBC,iv)</span><br><span class=\"line\">enc = aes.encrypt(pad(flag,48))</span><br><span class=\"line\">print(f&#x27;ns = &#123;ns&#125;&#x27;)</span><br><span class=\"line\">print(f&#x27;A = &#123;A&#125;&#x27;)</span><br><span class=\"line\">print(f&#x27;B = &#123;B&#125;&#x27;)</span><br><span class=\"line\">print(f&#x27;enc = &#123;enc&#125;&#x27;)</span><br><span class=\"line\"># ns = [38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970, 41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852, 41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406, 42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918, 31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848]</span><br><span class=\"line\"># A = [12789809461864875489953273982997537541385904671489556544122095227619591140533414669794423644619127980362623481580128258914287474542792728686579090501397390, 10463950513938701625808784986819665844287315724639315128677227520960105897990256530542006653611594269012930935073966767351788182657861624733138283749460454, 5253244650607533810967862436125419800679723144526973463211784033045021824966560017919956773745212139142517766154626849426827164032731516615725539069585525, 5644589184984504085855423002268477365020278981591337230721358313393863912025011466727192648804002734561676112555123877764178690726130713927642577324443238, 4231732567865883627242742552738439372803539125622706171540910152922080004603138662537022248675968288205781990968838888633816697065257733344028576518431020, 2483388920404524165854675814798022834892112957478917588986471421083048888193527751575039626887367465858751417977246719312923814782809309525841102293919541, 3252353812256192711411255830105475125944842449239880454539397067913664088094160819193268643401968970009466652179043139341471403913410402646923633696154454, 11575010486066232687430367040977113580882826853104996856464797182632266635060724100357205810604915010810884387573114266349621457564659060272935537811111850, 116107444921917032985259963199427176510900273385517435613848456370557161312731449337837406563733552524777525870560544042690403987311424820755256727586807, 5859050133610438843641532306693688255014116940390205022708310454673159702673207152462501010791971695002865650407033762568636006764435795015869726867643634, 5954075553161305677556950650395792531753502207483036473422070018485916621872566706504374038792527687442272405589975343003802956899043321092006127828986114, 4571747544457157571652286537158051402285727327066029382085461714597609990601683125994983291866807816649968826930652068427193317966970789937746419206862747, 7166507561570980603812241332170524724051295937096000768984168029904561160020043035660087151672164814332446644696618077835020463308343415953131944864257266, 4852042788460566411381271873349329096978244586097817622748766708426751073559942708861852208085367014057217116211249133109246735634468823924185525972777655, 11962941918999276757181090570698839032103646409734781047194175833198626142790676141060052011581957980660140931408560130449153056874213033784715711461403345, 10324508881746579337486319574059121005227580732153432145860775835052420139026016902518605634385512021513380467928195663920843022679549517463264144660593354, 13276257094435850052122403884510025189232513948002582716865201271569293297601525601586036713056700716929820641888489806178376555435219630186396004003438962, 6525051273399089095687950615197786094425890004112675057642687348101531212837185750558500720306108976630502328600886080197626115513445112562084719104488315, 12922888505610354933000354792496863801007995464403098763485264334670452387681468617068312646367483171083114539083453125614861357751571161533921864394641576, 9489726784141062031514945333087338495823600723655465328127755755022980083351477888038160719541864899912899592065620071698977397662002448273876711116012763, 10630316198843195148937849513165933809121991192035364160395429088101265852052098101114542104327663563661384303617672183366879116750889320604308038959012109, 12675564142993964272844760955973914547747654087592111324261755301551267959231076883765863344473167582531968290671984039948163579495803204811731286282708940, 11847724105274460405216443356582445218232627275228120716891711887600046501095390733716854871561352002320819466803698088448952127166615410820121973485089326, 5131676593756685549522564504727003861447389891839469018437277330988047271086971907217360711863971849879439418231726349935396008040776952541710218842744018, 8049060452950901277510497437779182190254362319091882684392717180429468875432078713802857488901441344429723298843967365750616860588029426099852763482179470, 2365060249260571713545479629411006471094806409182638354076861269679377537605360223984548798658469783472746989448405310909017645138161178501458084966625559, 7467521246204465304438401242342633361751371318557249418344587207503257890765643838557008735305668588521988487342275527781708126255070883848829062790678347, 5841608816993144092409175658260479687582056537041472535819914412630519543198558564258699185557903902095773598614097026740427138629173672250387442834578787, 3935779917509948624841228665498558015416911059417306651751360048412619176423173794541812556512582747588138532941031730797102738268660078594473168666677171, 1459083415233950534805962555425717865938763752937036513111696179351002303817986848490146888626704327653287774806488952733813718461674376764427084478395399, 6426876689549337938550615491086475536072547585103523407263007393570982327518298678278232288342601754164640081474537962710401178482959474762541185760732929, 5241364650650467046722868257809607948071188801137204831449976666385482519613365369974704486723941517654753205012497273820309153659423928739972270634209996, 6387483223002092292686097811446217867743566298067033295601210265979889577756648605354064672061975949925472022416479935990178719227937307079186916383092053, 170562164015232424518655058158727202269056868720093972639058422975773575660534168774299548952867348396798580779605954510297102765330549642318362861226163, 10004133230245713370426176448219282796530473722412487408402635996842671302539458739305597027107498342509248085998067976408732789438099488867425813748783724, 12325342879747412722323355648741345730921040452129462974449188258885453690169624888480720109964630270938743431623479816739889661554987977051169401841580388, 641543989928732942291347866597230552820621633110802944556141221591498546555080480758772801043509130524233886009444044150447511986129019395067102094826363]</span><br><span class=\"line\"># B = [108715652691370707411987210267535348806, 131676833696101475747102644851662113271, 122436706338521558335484593966234623745, 255864866572301552398412638474857375629, 81098761191414480003681301866161112100, 322322463176364397336266169283851913620, 198167679309202772183020662350938553923, 326360662842236388778385468938922853242, 241812832858991643670485138860832357660, 69768236619183466076110136290750715548, 32383134960394164339076842474280712870, 147747232748027508904245311745435517130, 25327826075608705748116808975774398964, 65295332681674581261444632606267440749, 236756211690281667988216748814564193312, 106435149910135092172124474857722935730, 270727089812520941022075406571244846193, 206881193220261276126028739930244917728, 131961838897694897398340205404861333362, 219211823942216355573832791993673934321, 150960424777134558142309786444952807101, 51112048255939343109218372373173385772, 182065623911902509203036774197184164110, 168420344895532090057957641972492853410, 301808673225362418769168353084541667053, 132272458662433671393247350648662880688, 495672626901999558635736361346563007, 182444159345379042372018248514964944782, 144584137563407779776361378564517880036, 338518705859818740467225748906995999694, 205885429741815676881969528495365151019, 233897982464483450790005953366237992668, 279307677123402840425362992920185630901, 133493426228159673166382443820069696429, 316624110847744871475435405969944304329, 187931604382397525131117897387179435812, 220019728924915067987393012581921164417]</span><br><span class=\"line\"># enc = b&#x27;cTmkMb\\xfc\\x05|\\x1d\\xc7\\x13\\xbaSe\\xe0\\xbd\\xc0\\xd9\\xa3\\x8cwo\\x82yN[B&amp;\\x80\\xd7KPwQ`\\x9c\\xbf&lt;y\\x8e\\x8a\\x97e\\xa074\\xb2&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">#c7-11ee-ae14-ac1203ab14da&#125;</span><br></pre></td></tr></table></figure></p>\n<p>é¦–å…ˆçœ‹åˆ°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = int(gmpy2.next_prime(bytes_to_long(key1 + os.urandom(64))))</span><br><span class=\"line\">ms = [random.getrandbits(256) for _ in range(num1)]</span><br><span class=\"line\">qs = [getPrime(1024) for _ in range(num1)]</span><br><span class=\"line\">ns = [p * qs[_] + ms[_] for _ in range(num1)]</span><br></pre></td></tr></table></figure></p>\n<p>æ˜¯ä¸€ä¸ªå…¸å‹çš„ AGCD çš„æ”»å‡»åœºæ™¯ï¼Œè¿™é‡Œæš‚æ—¶å°±ä¸ç»†è¯´äº†ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç«  <span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYXJ0aW5yYWxicmVjaHQud29yZHByZXNzLmNvbS8yMDIwLzAzLzIxL3RoZS1hcHByb3hpbWF0ZS1nY2QtcHJvYmxlbS8=\">https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/</span></p>\n<p>ç”¨åˆ°çš„æ ¼å­å°±æ˜¯</p>\n<p><img data-src=\"https://mmbiz.qpic.cn/sz_mmbiz_png/XpBS9rnxDafibiaFomS2g8k55FLBIVjaJ4CLpb2iaw0iassXAianogovjkdHwhYG3jZlAGtcYBhca1R7OYph3ONgJ0A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1\" alt=\"å›¾ç‰‡\" /></p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ns = [38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970, 41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852, 41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406, 42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918, 31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848]</span><br><span class=\"line\">x0,x1,x2,x3,x4 = ns</span><br><span class=\"line\"></span><br><span class=\"line\">B = matrix(ZZ,[[2^256,x1,x2,x3,x4],[0,-x0,0,0,0],[0,0,-x0,0,0],[0,0,0,-x0,0],[0,0,0,0,-x0]])</span><br><span class=\"line\">L = B.LLL()</span><br><span class=\"line\">ans= L[0][0] // 2^256</span><br><span class=\"line\"></span><br><span class=\"line\">p0 = abs(ans)</span><br><span class=\"line\">p = (x0 // p0)</span><br><span class=\"line\"></span><br><span class=\"line\"># p = 293423658885957174953198318664231534672400520068303593221989900395768107225130267646792968959460384248015583618158947268381852534151783869878808621629530642974652628810907251607210136313789978156955302211733219987661815438401343683</span><br><span class=\"line\">key1 = long_to_bytes(int(p))[:32]</span><br></pre></td></tr></table></figure></p>\n<p>æœ‰äº† p ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè·å–åˆ° msï¼Œè€Œ  <code>ms = [random.getrandbits(256) for _ in range(num1)]</code> ï¼Œ</p>\n<p>å¦å¤–ä¸‹é¢è¿˜æœ‰ä¸€ä¸ª</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for i in range(num2):</span><br><span class=\"line\">    a = random.getrandbits(512)</span><br></pre></td></tr></table></figure></p>\n<p>å› æ­¤æ ¹æ® ms å’Œ aï¼Œå…¸å‹çš„ mt19937 é¢„æµ‹éšæœºæ•°ï¼Œå°±èƒ½æåˆ° ivï¼Œç„¶åçœ‹åˆ°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iv = long_to_bytes(random.getrandbits(128))</span><br><span class=\"line\">key = xor(key1,key2)</span><br><span class=\"line\">aes = AES.new(key1,AES.MODE_CBC,iv)</span><br><span class=\"line\">enc = aes.encrypt(pad(flag,48))</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡ŒåŠ å¯†ç”¨çš„æ˜¯ key1 è€Œä¸æ˜¯ keyï¼Œï¼ˆéš¾å´©ï¼‰å› æ­¤æ ¹æœ¬ä¸éœ€è¦ç®¡ key2ï¼Œç›´æ¥ç”¨ iv å’Œ key1 è¿›è¡Œä¸€ä¸ª AES å¯†æ–‡çš„è§£å³å¯ã€‚</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ns = [38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970, 41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852, 41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406, 42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918, 31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848]</span><br><span class=\"line\">p = 293423658885957174953198318664231534672400520068303593221989900395768107225130267646792968959460384248015583618158947268381852534151783869878808621629530642974652628810907251607210136313789978156955302211733219987661815438401343683</span><br><span class=\"line\">ms = [i%p for i in ns]</span><br><span class=\"line\">x = []</span><br><span class=\"line\">for each in ms:</span><br><span class=\"line\">    tmp = each</span><br><span class=\"line\">    while tmp &gt;0:</span><br><span class=\"line\">        x.append(tmp%(2**32))</span><br><span class=\"line\">        tmp &gt;&gt;= 32</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">A = [12789809461864875489953273982997537541385904671489556544122095227619591140533414669794423644619127980362623481580128258914287474542792728686579090501397390, 10463950513938701625808784986819665844287315724639315128677227520960105897990256530542006653611594269012930935073966767351788182657861624733138283749460454, 5253244650607533810967862436125419800679723144526973463211784033045021824966560017919956773745212139142517766154626849426827164032731516615725539069585525, 5644589184984504085855423002268477365020278981591337230721358313393863912025011466727192648804002734561676112555123877764178690726130713927642577324443238, 4231732567865883627242742552738439372803539125622706171540910152922080004603138662537022248675968288205781990968838888633816697065257733344028576518431020, 2483388920404524165854675814798022834892112957478917588986471421083048888193527751575039626887367465858751417977246719312923814782809309525841102293919541, 3252353812256192711411255830105475125944842449239880454539397067913664088094160819193268643401968970009466652179043139341471403913410402646923633696154454, 11575010486066232687430367040977113580882826853104996856464797182632266635060724100357205810604915010810884387573114266349621457564659060272935537811111850, 116107444921917032985259963199427176510900273385517435613848456370557161312731449337837406563733552524777525870560544042690403987311424820755256727586807, 5859050133610438843641532306693688255014116940390205022708310454673159702673207152462501010791971695002865650407033762568636006764435795015869726867643634, 5954075553161305677556950650395792531753502207483036473422070018485916621872566706504374038792527687442272405589975343003802956899043321092006127828986114, 4571747544457157571652286537158051402285727327066029382085461714597609990601683125994983291866807816649968826930652068427193317966970789937746419206862747, 7166507561570980603812241332170524724051295937096000768984168029904561160020043035660087151672164814332446644696618077835020463308343415953131944864257266, 4852042788460566411381271873349329096978244586097817622748766708426751073559942708861852208085367014057217116211249133109246735634468823924185525972777655, 11962941918999276757181090570698839032103646409734781047194175833198626142790676141060052011581957980660140931408560130449153056874213033784715711461403345, 10324508881746579337486319574059121005227580732153432145860775835052420139026016902518605634385512021513380467928195663920843022679549517463264144660593354, 13276257094435850052122403884510025189232513948002582716865201271569293297601525601586036713056700716929820641888489806178376555435219630186396004003438962, 6525051273399089095687950615197786094425890004112675057642687348101531212837185750558500720306108976630502328600886080197626115513445112562084719104488315, 12922888505610354933000354792496863801007995464403098763485264334670452387681468617068312646367483171083114539083453125614861357751571161533921864394641576, 9489726784141062031514945333087338495823600723655465328127755755022980083351477888038160719541864899912899592065620071698977397662002448273876711116012763, 10630316198843195148937849513165933809121991192035364160395429088101265852052098101114542104327663563661384303617672183366879116750889320604308038959012109, 12675564142993964272844760955973914547747654087592111324261755301551267959231076883765863344473167582531968290671984039948163579495803204811731286282708940, 11847724105274460405216443356582445218232627275228120716891711887600046501095390733716854871561352002320819466803698088448952127166615410820121973485089326, 5131676593756685549522564504727003861447389891839469018437277330988047271086971907217360711863971849879439418231726349935396008040776952541710218842744018, 8049060452950901277510497437779182190254362319091882684392717180429468875432078713802857488901441344429723298843967365750616860588029426099852763482179470, 2365060249260571713545479629411006471094806409182638354076861269679377537605360223984548798658469783472746989448405310909017645138161178501458084966625559, 7467521246204465304438401242342633361751371318557249418344587207503257890765643838557008735305668588521988487342275527781708126255070883848829062790678347, 5841608816993144092409175658260479687582056537041472535819914412630519543198558564258699185557903902095773598614097026740427138629173672250387442834578787, 3935779917509948624841228665498558015416911059417306651751360048412619176423173794541812556512582747588138532941031730797102738268660078594473168666677171, 1459083415233950534805962555425717865938763752937036513111696179351002303817986848490146888626704327653287774806488952733813718461674376764427084478395399, 6426876689549337938550615491086475536072547585103523407263007393570982327518298678278232288342601754164640081474537962710401178482959474762541185760732929, 5241364650650467046722868257809607948071188801137204831449976666385482519613365369974704486723941517654753205012497273820309153659423928739972270634209996, 6387483223002092292686097811446217867743566298067033295601210265979889577756648605354064672061975949925472022416479935990178719227937307079186916383092053, 170562164015232424518655058158727202269056868720093972639058422975773575660534168774299548952867348396798580779605954510297102765330549642318362861226163, 10004133230245713370426176448219282796530473722412487408402635996842671302539458739305597027107498342509248085998067976408732789438099488867425813748783724, 12325342879747412722323355648741345730921040452129462974449188258885453690169624888480720109964630270938743431623479816739889661554987977051169401841580388, 641543989928732942291347866597230552820621633110802944556141221591498546555080480758772801043509130524233886009444044150447511986129019395067102094826363]</span><br><span class=\"line\"></span><br><span class=\"line\">for each in A:</span><br><span class=\"line\">    tmp = each</span><br><span class=\"line\">    while tmp &gt;0:</span><br><span class=\"line\">        x.append(tmp%(2**32))</span><br><span class=\"line\">        tmp &gt;&gt;= 32</span><br><span class=\"line\">print(len(x))</span><br><span class=\"line\">from MT19937_Crack import *</span><br><span class=\"line\">mtb = MT19937Recover()</span><br><span class=\"line\">result = mtb.go_on(x) </span><br><span class=\"line\">enc = b&#x27;cTmkMb\\xfc\\x05|\\x1d\\xc7\\x13\\xbaSe\\xe0\\xbd\\xc0\\xd9\\xa3\\x8cwo\\x82yN[B&amp;\\x80\\xd7KPwQ`\\x9c\\xbf&lt;y\\x8e\\x8a\\x97e\\xa074\\xb2&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">import random</span><br><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\">key1 = b&#x27;0b5e732a48fc8c6f5ac6366212d2bc59&#x27;</span><br><span class=\"line\">iv = long_to_bytes(result.getrandbits(128))</span><br><span class=\"line\">aes = AES.new(key1,AES.MODE_CBC,iv)</span><br><span class=\"line\">enc = aes.decrypt(enc)</span><br><span class=\"line\">print(enc)</span><br></pre></td></tr></table></figure></p>\n<p>å¾—åˆ° b'flag {86baa4ed-5ec7-11ee-ae14-ac1203ab14da}\\x06\\x06\\x06\\x06\\x06\\x06'</p>\n<p>å½“ç„¶ï¼Œå¦‚æœè¿˜æ˜¯æƒ³è¦è§£å‡º key2 ï¼Œå…¶å®è¿™å°±æ˜¯ 2022 å¹´å…¨å›½é«˜æ ¡å¯†ç æ•°å­¦æŒ‘æˆ˜èµ›çš„ä¸€ä¸ªèµ›é¢˜ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ @tover çš„åšå®¢ <span class=\"exturl\" data-url=\"aHR0cHM6Ly90b3Zlci54eXovcC9ITlAtbm90ZS8jTGV2ZWwtMw==\">https://tover.xyz/p/HNP-note/#Level-3</span> ï¼Œå†™çš„æŒºè¯¦ç»†äº†å·²ç»ã€‚</p>\n<h3 id=\"secretshare\"><a class=\"anchor\" href=\"#secretshare\">#</a> [SecretShare]</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import random </span><br><span class=\"line\">from secret import flag, secret</span><br><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\"></span><br><span class=\"line\">n = 21</span><br><span class=\"line\">t = 21</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">A = [secret]</span><br><span class=\"line\">for i in range(n-1):</span><br><span class=\"line\">    A.append(random.getrandbits(1024))</span><br><span class=\"line\"></span><br><span class=\"line\">X = []</span><br><span class=\"line\">for i in range(n):</span><br><span class=\"line\">    X.append(random.getrandbits(1024))</span><br><span class=\"line\"></span><br><span class=\"line\">p = getPrime(1026)</span><br><span class=\"line\"></span><br><span class=\"line\">def f(x):</span><br><span class=\"line\">    res = 0</span><br><span class=\"line\">    tmp = 1</span><br><span class=\"line\">    for i in range(n):</span><br><span class=\"line\">        res = (res + tmp * A[i]) % p </span><br><span class=\"line\">        tmp = tmp *x  % p</span><br><span class=\"line\">    return res % p</span><br><span class=\"line\"># res = a0+a1*x+a2*x^2+a3*x3+...+a20*x20</span><br><span class=\"line\"></span><br><span class=\"line\">R = []</span><br><span class=\"line\">for i in range(n):</span><br><span class=\"line\">    R.append(f(X[i]))</span><br><span class=\"line\"></span><br><span class=\"line\">P = secret</span><br><span class=\"line\">Q = getPrime(1024)</span><br><span class=\"line\">N = P * Q</span><br><span class=\"line\">m = bytes_to_long(flag)</span><br><span class=\"line\">e = 65537</span><br><span class=\"line\">c = pow(m, e, N)</span><br><span class=\"line\">phi=(P - 1) * (Q - 1)</span><br><span class=\"line\">d = pow(e,-1,phi)</span><br><span class=\"line\">print(long_to_bytes(pow(c,d,N)))</span><br><span class=\"line\"></span><br><span class=\"line\">fi = open(&#x27;output.txt&#x27;,&#x27;w&#x27;)</span><br><span class=\"line\">for i in range(t-1):</span><br><span class=\"line\">    fi.write(str(X[i])+&#x27; &#x27;+str(R[i])+&#x27;\\n&#x27;)</span><br><span class=\"line\">print(&quot;leak = %d&quot;%R[-1])</span><br><span class=\"line\">print(&quot;p = %d&quot;%p)</span><br><span class=\"line\">print(&quot;c = %d&quot;%c)</span><br><span class=\"line\">print(&quot;N = %d&quot;%N)</span><br><span class=\"line\"></span><br><span class=\"line\"># leak = 158171468736013100218170873274656605219228738469715092751861925345310881653082508445746109167302799236685145510095499361526242392251594397820661050281094210672424887670015189702781308615421102937559185479455827148241690888934661637911906309379701856488858180027365752169466863585611322838180758159364570481257</span><br><span class=\"line\"># p = 667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029   </span><br><span class=\"line\"># c = 9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br><span class=\"line\"># N = 11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é“é¢˜å°±æ›´ç®€å•äº†ï¼ˆå¯èƒ½åˆæ˜¯å‡ºé¢˜å¤±è¯¯ï¼Œä¿¡æ¯æ”¾å‡ºæ¥å¤šäº†ï¼‰ï¼Œ</p>\n<p>å…¶ä¸­  <code>f(x)</code>  å‡½æ•°å¯ä»¥è®°ä¸º</p>\n<p>æ•°ç»„ A å’Œ X éƒ½æ˜¯ç”± 21 ä¸ª 1024 æ¯”ç‰¹çš„æ•°ç»„æˆï¼Œå…¶ä¸­ A çš„å 20 ä¸ªæ˜¯  <code>random.getrandbits(1024)</code> ï¼Œ 21 ä¸ª X éƒ½æ˜¯  <code>random.getrandbits(1024)</code></p>\n<p>1024/32*21=672ï¼Œè¶³è¶³çš„äº†ã€‚ç›´æ¥å°±èƒ½å¾€å‰æŠŠ 20 ä¸ª a å…¨éƒ¨æ¢å¤ã€‚è¿™é‡ŒåˆæŠŠ x å…¨éƒ¨ç»™å‡ºæ¥äº†ï¼Œå¯¹åº”çš„ r ä¹Ÿç»™äº†ï¼ŒP  å°±æ˜¯</p>\n<p>é‚£ç›´æ¥</p>\n<p>å†è§£ä¸€ä¸‹ RSA å°±å®Œæ´»äº†ã€‚</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&quot;output.txt&quot;) as f:</span><br><span class=\"line\">        data = f.read().split(&quot;\\n&quot;)[:-1]</span><br><span class=\"line\">X=[]</span><br><span class=\"line\">R=[]</span><br><span class=\"line\">for each in data:</span><br><span class=\"line\">        tm = each.split(&quot; &quot;)</span><br><span class=\"line\">        X.append(int(tm[0]))</span><br><span class=\"line\">        R.append(int(tm[1]))</span><br><span class=\"line\">print(len(X))</span><br><span class=\"line\"></span><br><span class=\"line\">x = []</span><br><span class=\"line\">for each in X:</span><br><span class=\"line\">        tmp = each</span><br><span class=\"line\">        while tmp &gt;0:</span><br><span class=\"line\">                x.append(tmp%(2**32))</span><br><span class=\"line\">                tmp &gt;&gt;= 32</span><br><span class=\"line\">print(len(x))</span><br><span class=\"line\">from MT19937_Crack import *</span><br><span class=\"line\">mtb = MT19937Recover()</span><br><span class=\"line\">result = mtb.go_back(x,608)</span><br><span class=\"line\"></span><br><span class=\"line\">def factory(res):</span><br><span class=\"line\">        ans=[]</span><br><span class=\"line\">        for i in range(0,len(res)//32):</span><br><span class=\"line\">                tmp = 0</span><br><span class=\"line\">                for j in range(32):</span><br><span class=\"line\">                        tmp+=res[32*i+j]&lt;&lt;(j*32)</span><br><span class=\"line\">                ans.append(tmp)</span><br><span class=\"line\">        return ans</span><br><span class=\"line\">A = factory(result)</span><br><span class=\"line\"></span><br><span class=\"line\">value = result+x</span><br><span class=\"line\">result = mtb.go_back(value,32)</span><br><span class=\"line\">A = factory(result)+A</span><br><span class=\"line\">print(len(A))</span><br><span class=\"line\"></span><br><span class=\"line\">x =  X[0]</span><br><span class=\"line\">res = R[0]</span><br><span class=\"line\">p = 667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029</span><br><span class=\"line\">for i in range(1,21):</span><br><span class=\"line\">        res = (res-A[i-1]*x**i)%p</span><br><span class=\"line\">N = 11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p=res</span><br><span class=\"line\">q=N//res</span><br><span class=\"line\">c = 9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br><span class=\"line\"></span><br><span class=\"line\">e = 65537</span><br><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\">d = inverse(e,(p-1)*(q-1))</span><br><span class=\"line\">print(long_to_bytes(pow(c,d,p*q)))</span><br></pre></td></tr></table></figure></p>\n",
            "tags": []
        },
        {
            "id": "https://justgo00.github.io/2023/12/11/hello-world/",
            "url": "https://justgo00.github.io/2023/12/11/hello-world/",
            "title": "Hello World",
            "date_published": "2023-12-11T05:15:22.063Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure></p>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure></p>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure></p>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure></p>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": []
        }
    ]
}